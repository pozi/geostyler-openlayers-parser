var GeoStylerOpenlayersParser=function(b){"use strict";var pr=Object.defineProperty;var vr=(b,I,M)=>I in b?pr(b,I,{enumerable:!0,configurable:!0,writable:!0,value:M}):b[I]=M;var C=(b,I,M)=>(vr(b,typeof I!="symbol"?I+"":I,M),M);function I(n){return!/^(-?\d|--)/.test(n)}function M(n){const e=[];let t="",i="",r=7;for(let s,a=0;s=n.charAt(a);a++)if(/[a-zA-Z\d\xa0-\uffff_-]/.test(s)&&r===7)t+=s;else if(s==="\\"&&r===7)r=6;else if(s===" "&&r===7){if(t!==""){if(!I(t))return null;e.push(t),t=""}}else if(r===6)/[0-9a-f]/i.test(s)?(i+=s,r=8):(t+=s,r=7);else{if(r!==8)return null;/[0-9a-f]/i.test(s)&&i.length<6?i+=s:(t+=String.fromCodePoint(parseInt(i,16)),t+=s,i="",r=7)}if(t!==""){if(!I(t))return null;e.push(t)}return e.join(" ")}function mt(n,e){let t=e,i="";const r={"font-family":[]};for(let s,a=0;s=n.charAt(a);a+=1)if(t!==4||s!=='"'&&s!=="'")if(t===3&&s===",")t=4,i="";else if(t===4&&s===","){const o=M(i);o&&r["font-family"].push(o),i=""}else if(t===5&&s===" ")/^(?:\+|-)?(?:[0-9]*\.)?[0-9]+(?:deg|grad|rad|turn)$/.test(i)?(r["font-style"]+=" "+i,i=""):a-=1,t=1;else if(t!==1||s!==" "&&s!=="/")t===2&&s===" "?(/^(?:\+|-)?([0-9]*\.)?[0-9]+(?:em|ex|ch|rem|vh|vw|vmin|vmax|px|mm|cm|in|pt|pc|%)?$/.test(i)&&(r["line-height"]=i),t=4,i=""):i+=s;else{if(/^(?:(?:xx|x)-large|(?:xx|s)-small|small|large|medium)$/.test(i)||/^(?:larg|small)er$/.test(i)||/^(?:\+|-)?(?:[0-9]*\.)?[0-9]+(?:em|ex|ch|rem|vh|vw|vmin|vmax|px|mm|cm|in|pt|pc|%)$/.test(i))t=s==="/"?2:4,r["font-size"]=i;else if(/^italic$/.test(i))r["font-style"]=i;else if(/^oblique$/.test(i))r["font-style"]=i,t=5;else if(/^small-caps$/.test(i))r["font-variant"]=i;else if(/^(?:bold(?:er)?|lighter|normal)$/.test(i))r["font-weight"]=i;else if(/^[+-]?(?:[0-9]*\.)?[0-9]+(?:e[+-]?(?:0|[1-9][0-9]*))?$/.test(i)){const o=parseFloat(i);o>=1&&o<=1e3&&(r["font-weight"]=i)}else/^(?:(?:ultra|extra|semi)-)?(?:condensed|expanded)$/.test(i)&&(r["font-stretch"]=i);i=""}else{let o=a+1;do if(o=n.indexOf(s,o)+1,!o)return null;while(n.charAt(o-2)==="\\");r["font-family"].push(n.slice(a+1,o-1).replace(/\\('|")/g,"$1")),a=o-1,t=3,i=""}if(t===3&&!/^\s*$/.test(i))return null;if(t===4){const s=M(i);s&&r["font-family"].push(s)}return r}function pt(n){const e=mt(n,1);return e!==null&&e["font-size"]&&e["font-family"].length?e:null}function vt(n){return n!=null&&typeof n.valueOf()=="string"}const wt=n=>(n==null?void 0:n.kind)==="Icon",yt=n=>(n==null?void 0:n.kind)==="Mark"&&vt(n==null?void 0:n.wellKnownName),ie=n=>["abs","acos","add","asin","atan","atan2","ceil","cos","div","exp","floor","interpolate","log","max","min","modulo","mul","pi","pow","random","rint","round","sin","sqrt","strIndexOf","strLastIndexOf","strLength","sub","tan","toDegrees","toNumber","toRadians"].includes(n==null?void 0:n.name),W=n=>["numberFormat","strAbbreviate","strCapitalize","strConcat","strDefaultIfBlank","strReplace","strStripAccents","strSubstring","strSubstringStart","strToLowerCase","strToString","strToUpperCase","strTrim"].includes(n==null?void 0:n.name),j=n=>["all","any","between","double2bool","equalTo","greaterThan","greaterThanOrEqualTo","in","lessThan","lessThanOrEqualTo","not","notEqualTo","parseBoolean","strEndsWith","strEqualsIgnoreCase","strMatches","strStartsWith"].includes(n==null?void 0:n.name),be=n=>["case","property","step"].includes(n==null?void 0:n.name),S=n=>j(n)||ie(n)||W(n)||be(n),ne=n=>typeof(n==null?void 0:n.source)=="string"||S(n==null?void 0:n.source)&&Array.isArray(n.position)&&Array.isArray(n.size);var k={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class St{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}var Fe=St,xt={PROPERTYCHANGE:"propertychange"};class kt{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}var Ot=kt;function Ie(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function Le(){}function Ct(n){let e=!1,t,i,r;return function(){const s=Array.prototype.slice.call(arguments);return(!e||this!==r||!Ie(s,i))&&(e=!0,r=this,i=s,t=n.apply(this,arguments)),t}}function Me(n){for(const e in n)delete n[e]}function bt(n){let e;for(e in n)return!1;return!e}class Ft extends Ot{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Fe(e):e;s.target||(s.target=this.eventTarget_||this);const a=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});i in a||(a[i]=0,o[i]=0),++a[i];let l;for(let h=0,f=r.length;h<f;++h)if("handleEvent"in r[h]?l=r[h].handleEvent(s):l=r[h].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--a[i]===0){let h=o[i];for(delete o[i];h--;)this.removeEventListener(i,Le);delete a[i]}return l}disposeInternal(){this.listeners_&&Me(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=Le,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}var Pe=Ft,X={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function re(n,e,t,i,r){if(i&&i!==n&&(t=t.bind(i)),r){const a=t;t=function(){n.removeEventListener(e,t),a.apply(this,arguments)}}const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Te(n,e,t,i){return re(n,e,t,i,!0)}function Ee(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),Me(n))}class Y extends Pe{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(X.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=re(this,e[s],t);return r}return re(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Te(this,e[s],t)}else i=Te(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)It(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}Y.prototype.on,Y.prototype.once,Y.prototype.un;function It(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Ee(n[e]);else Ee(n)}var Lt=Y;function y(){throw new Error("Unimplemented abstract method.")}let Mt=0;function Ae(n){return n.ol_uid||(n.ol_uid=String(++Mt))}class Re extends Fe{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class Pt extends Lt{constructor(e){super(),this.on,this.once,this.un,Ae(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new Re(i,e,t)),i=xt.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new Re(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],bt(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}var De=Pt;const P=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"";P.includes("firefox"),P.includes("safari")&&!P.includes("chrom")&&(P.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(P)),P.includes("webkit")&&P.includes("edge"),P.includes("macintosh");const Tt=typeof devicePixelRatio<"u"?devicePixelRatio:1,Et=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,At=typeof Image<"u"&&Image.prototype.decode;(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})();function se(n,e){if(!n)throw new Error(e)}const Rt=new Array(6);function ae(){return[1,0,0,1,0,0]}function Dt(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],a=n[4],o=n[5],l=e[0],h=e[1],f=e[2],u=e[3],c=e[4],d=e[5];return n[0]=t*l+r*h,n[1]=i*l+s*h,n[2]=t*f+r*u,n[3]=i*f+s*u,n[4]=t*c+r*d+a,n[5]=i*c+s*d+o,n}function zt(n,e,t,i,r,s,a){return n[0]=e,n[1]=t,n[2]=i,n[3]=r,n[4]=s,n[5]=a,n}function Wt(n,e,t){return Dt(n,zt(Rt,e,0,0,t,0,0))}function ze(n,e,t,i,r,s,a,o){const l=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*l,n[2]=-i*l,n[3]=r*h,n[4]=a*i*h-o*i*l+e,n[5]=a*r*l+o*r*h+t,n}function qt(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function Gt(){return[1/0,1/0,-1/0,-1/0]}function We(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function qe(n){return We(1/0,1/0,-1/0,-1/0,n)}function Nt(n,e){const t=n[0],i=n[1];return We(t,i,t,i,e)}function $t(n,e,t,i,r){const s=qe(r);return Bt(s,n,e,t,i)}function Bt(n,e,t,i,r){for(;t<i;t+=r)jt(n,e[t],e[t+1]);return n}function jt(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function Xt(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function Ge(n){return n[3]-n[1]}function q(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Yt(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}const Ne={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Vt{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Ne[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}var $e=Vt;const G=6378137,A=Math.PI*G,Ht=[-A,-A,A,A],Ut=[-180,-85,180,85],V=G*Math.log(Math.tan(Math.PI/2));class R extends $e{constructor(e){super({code:e,units:"m",extent:Ht,global:!0,worldExtent:Ut,getPointResolution:function(t,i){return t/Math.cosh(i[1]/G)}})}}const Be=[new R("EPSG:3857"),new R("EPSG:102100"),new R("EPSG:102113"),new R("EPSG:900913"),new R("http://www.opengis.net/def/crs/EPSG/0/3857"),new R("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Jt(n,e,t){const i=n.length;t=t>1?t:2,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let r=0;r<i;r+=t){e[r]=A*n[r]/180;let s=G*Math.log(Math.tan(Math.PI*(+n[r+1]+90)/360));s>V?s=V:s<-V&&(s=-V),e[r+1]=s}return e}function Kt(n,e,t){const i=n.length;t=t>1?t:2,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let r=0;r<i;r+=t)e[r]=180*n[r]/A,e[r+1]=360*Math.atan(Math.exp(n[r+1]/G))/Math.PI-90;return e}const Zt=6378137,je=[-180,-90,180,90],Qt=Math.PI*Zt/180;class E extends $e{constructor(e,t){super({code:e,units:"degrees",extent:je,axisOrientation:t,global:!0,metersPerUnit:Qt,worldExtent:je})}}const Xe=[new E("CRS:84"),new E("EPSG:4326","neu"),new E("urn:ogc:def:crs:OGC:1.3:CRS84"),new E("urn:ogc:def:crs:OGC:2:84"),new E("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new E("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new E("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let oe={};function ei(n){return oe[n]||oe[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function ti(n,e){oe[n]=e}let D={};function H(n,e,t){const i=n.getCode(),r=e.getCode();i in D||(D[i]={}),D[i][r]=t}function ii(n,e){let t;return n in D&&e in D[n]&&(t=D[n][e]),t}function U(n,e,t){return Math.min(Math.max(n,e),t)}function ni(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function ri(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function Ye(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function si(n,e){if(e!==void 0&&n!==e){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];n=e}return n}function ai(n){ti(n.getCode(),n),H(n,n,Ye)}function oi(n){n.forEach(ai)}function le(n){return typeof n=="string"?ei(n):n||null}function Ve(n){oi(n),n.forEach(function(e){n.forEach(function(t){e!==t&&H(e,t,Ye)})})}function li(n,e,t,i){n.forEach(function(r){e.forEach(function(s){H(r,s,t),H(s,r,i)})})}function hi(n,e){const t=n.getCode(),i=e.getCode();let r=ii(t,i);return r||(r=si),r}function He(n,e){const t=le(n),i=le(e);return hi(t,i)}function ci(){Ve(Be),Ve(Xe),li(Xe,Be,Jt,Kt)}ci();function N(n,e,t,i,r,s){s=s||[];let a=0;for(let o=e;o<t;o+=i){const l=n[o],h=n[o+1];s[a++]=r[0]*l+r[2]*h+r[4],s[a++]=r[1]*l+r[3]*h+r[5]}return s&&s.length!=a&&(s.length=a),s}function ui(n,e,t,i,r,s,a){a=a||[];const o=Math.cos(r),l=Math.sin(r),h=s[0],f=s[1];let u=0;for(let c=e;c<t;c+=i){const d=n[c]-h,m=n[c+1]-f;a[u++]=h+d*o-m*l,a[u++]=f+d*l+m*o;for(let _=c+2;_<c+i;++_)a[u++]=n[_]}return a&&a.length!=u&&(a.length=u),a}function fi(n,e,t,i,r,s,a,o){o=o||[];const l=a[0],h=a[1];let f=0;for(let u=e;u<t;u+=i){const c=n[u]-l,d=n[u+1]-h;o[f++]=l+r*c,o[f++]=h+s*d;for(let m=u+2;m<u+i;++m)o[f++]=n[m]}return o&&o.length!=f&&(o.length=f),o}function gi(n,e,t,i,r,s,a){a=a||[];let o=0;for(let l=e;l<t;l+=i){a[o++]=n[l]+r,a[o++]=n[l+1]+s;for(let h=l+2;h<l+i;++h)a[o++]=n[h]}return a&&a.length!=o&&(a.length=o),a}const Ue=ae();class di extends De{constructor(){super(),this.extent_=Gt(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Ct((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return y()}closestPointXY(e,t,i,r){return y()}containsXY(e,t){const i=this.getClosestPoint([e,t]);return i[0]===e&&i[1]===t}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return y()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&qe(t),this.extentRevision_=this.getRevision()}return Yt(this.extent_,e)}rotate(e,t){y()}scale(e,t,i){y()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return y()}getType(){return y()}applyTransform(e){y()}intersectsExtent(e){return y()}translate(e,t){y()}transform(e,t){const i=le(e),r=i.getUnits()=="tile-pixels"?function(s,a,o){const l=i.getExtent(),h=i.getWorldExtent(),f=Ge(h)/Ge(l);return ze(Ue,h[0],h[3],f,-f,0,0,0),N(s,0,s.length,o,Ue,a),He(i,t)(s,a,o)}:He(i,t);return this.applyTransform(r),this}}var _i=di;class mi extends _i{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return $t(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return y()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=Je(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){y()}setLayout(e,t,i){let r;if(e)r=Je(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=pi(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();ui(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=Xt(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();fi(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();gi(i,0,i.length,r,e,t,i),this.changed()}}}function pi(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function Je(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function vi(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return N(i,0,i.length,r,e,t)}var wi=mi;function yi(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}class he extends wi{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new he(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,a=ni(e,t,s[0],s[1]);if(a<r){const o=this.stride;for(let l=0;l<o;++l)i[l]=s[l];return i.length=o,a}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return Nt(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return qt(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=yi(this.flatCoordinates,0,e,this.stride),this.changed()}}var Si=he;function J(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class ce{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=J(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new ce({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return y()}getImage(e){return y()}getHitDetectionImage(){return y()}getPixelRatio(e){return 1}getImageState(){return y()}getImageSize(){return y()}getOrigin(){return y()}getSize(){return y()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=J(e)}listenImageChange(e){y()}load(){y()}unlistenImageChange(e){y()}}var ue=ce,K={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},O={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"]};O.whitepoint={2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}},O.max=O.whitepoint[2].D65,O.rgb=function(n,e){e=e||O.whitepoint[2].E;var t=n[0]/e[0],i=n[1]/e[1],r=n[2]/e[2],s,a,o;return s=t*3.240969941904521+i*-1.537383177570093+r*-.498610760293,a=t*-.96924363628087+i*1.87596750150772+r*.041555057407175,o=t*.055630079696993+i*-.20397695888897+r*1.056971514242878,s=s>.0031308?1.055*Math.pow(s,.4166666666666667)-.055:s=s*12.92,a=a>.0031308?1.055*Math.pow(a,.4166666666666667)-.055:a=a*12.92,o=o>.0031308?1.055*Math.pow(o,.4166666666666667)-.055:o=o*12.92,s=Math.min(Math.max(0,s),1),a=Math.min(Math.max(0,a),1),o=Math.min(Math.max(0,o),1),[s*255,a*255,o*255]},K.xyz=function(n,e){var t=n[0]/255,i=n[1]/255,r=n[2]/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;var s=t*.41239079926595+i*.35758433938387+r*.18048078840183,a=t*.21263900587151+i*.71516867876775+r*.072192315360733,o=t*.019330818715591+i*.11919477979462+r*.95053215224966;return e=e||O.whitepoint[2].E,[s*e[0],a*e[1],o*e[2]]};var Ke={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(n,e,t){var i,r,s,a,o,l,h,f,u,c,d,m,_;if(s=n[0],a=n[1],o=n[2],s===0)return[0,0,0];var p=.0011070564598794539;return e=e||"D65",t=t||2,u=O.whitepoint[t][e][0],c=O.whitepoint[t][e][1],d=O.whitepoint[t][e][2],m=4*u/(u+15*c+3*d),_=9*c/(u+15*c+3*d),i=a/(13*s)+m||0,r=o/(13*s)+_||0,h=s>8?c*Math.pow((s+16)/116,3):c*s*p,l=h*9*i/(4*r)||0,f=h*(12-3*i-20*r)/(4*r)||0,[l,h,f]}};O.luv=function(n,e,t){var i,r,s,a,o,l,h,f,u,c,d,m,_,p=.008856451679035631,v=903.2962962962961;e=e||"D65",t=t||2,u=O.whitepoint[t][e][0],c=O.whitepoint[t][e][1],d=O.whitepoint[t][e][2],m=4*u/(u+15*c+3*d),_=9*c/(u+15*c+3*d),l=n[0],h=n[1],f=n[2],i=4*l/(l+15*h+3*f)||0,r=9*h/(l+15*h+3*f)||0;var w=h/c;return s=w<=p?v*w:116*Math.pow(w,.3333333333333333)-16,a=13*s*(i-m),o=13*s*(r-_),[s,a,o]},Ke.lchuv=function(n){var e=n[0],t=n[1],i=n[2],r=Math.sqrt(t*t+i*i),s=Math.atan2(i,t),a=s*360/2/Math.PI;return a<0&&(a+=360),[e,r,a]},O.lchuv=function(n){return Ke.lchuv(O.luv(n))};var Ze={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Qe={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function xi(n){var f,u;var e,t=[],i=1,r;if(typeof n=="number")return{space:"rgb",values:[n>>>16,(n&65280)>>>8,n&255],alpha:1};if(typeof n=="number")return{space:"rgb",values:[n>>>16,(n&65280)>>>8,n&255],alpha:1};if(n=String(n).toLowerCase(),Ze[n])t=Ze[n].slice(),r="rgb";else if(n==="transparent")i=0,r="rgb",t=[0,0,0];else if(n[0]==="#"){var s=n.slice(1),a=s.length,o=a<=4;i=1,o?(t=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],a===4&&(i=parseInt(s[3]+s[3],16)/255)):(t=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],a===8&&(i=parseInt(s[6]+s[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),r="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(n)){var l=e[1];r=l.replace(/a$/,"");var h=r==="cmyk"?4:r==="gray"?1:3;t=e[2].trim().split(/\s*[,\/]\s*|\s+/),r==="color"&&(r=t.shift()),t=t.map(function(c,d){if(c[c.length-1]==="%")return c=parseFloat(c)/100,d===3?c:r==="rgb"?c*255:r[0]==="h"||r[0]==="l"&&!d?c*100:r==="lab"?c*125:r==="lch"?d<2?c*150:c*360:r[0]==="o"&&!d?c:r==="oklab"?c*.4:r==="oklch"?d<2?c*.4:c*360:c;if(r[d]==="h"||d===2&&r[r.length-1]==="h"){if(Qe[c]!==void 0)return Qe[c];if(c.endsWith("deg"))return parseFloat(c);if(c.endsWith("turn"))return parseFloat(c)*360;if(c.endsWith("grad"))return parseFloat(c)*360/400;if(c.endsWith("rad"))return parseFloat(c)*180/Math.PI}return c==="none"?0:parseFloat(c)}),i=t.length>h?t.pop():1}else/[0-9](?:\s|\/|,)/.test(n)&&(t=n.match(/([0-9]+)/g).map(function(c){return parseFloat(c)}),r=((u=(f=n.match(/([a-z])/ig))==null?void 0:f.join(""))==null?void 0:u.toLowerCase())||"rgb");return{space:r,values:t,alpha:i}}var fe={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(n){var e=n[0]/360,t=n[1]/100,i=n[2]/100,r,s,a,o,l,h=0;if(t===0)return l=i*255,[l,l,l];for(s=i<.5?i*(1+t):i+t-i*t,r=2*i-s,o=[0,0,0];h<3;)a=e+1/3*-(h-1),a<0?a++:a>1&&a--,l=6*a<1?r+(s-r)*6*a:2*a<1?s:3*a<2?r+(s-r)*(2/3-a)*6:r,o[h++]=l*255;return o}};K.hsl=function(n){var e=n[0]/255,t=n[1]/255,i=n[2]/255,r=Math.min(e,t,i),s=Math.max(e,t,i),a=s-r,o,l,h;return s===r?o=0:e===s?o=(t-i)/a:t===s?o=2+(i-e)/a:i===s&&(o=4+(e-t)/a),o=Math.min(o*60,360),o<0&&(o+=360),h=(r+s)/2,s===r?l=0:h<=.5?l=a/(s+r):l=a/(2-s-r),[o,l*100,h*100]};function ki(n){Array.isArray(n)&&n.raw&&(n=String.raw(...arguments)),n instanceof Number&&(n=+n);var e,t=xi(n);if(!t.space)return[];const i=t.space[0]==="h"?fe.min:K.min,r=t.space[0]==="h"?fe.max:K.max;return e=Array(3),e[0]=Math.min(Math.max(t.values[0],i[0]),r[0]),e[1]=Math.min(Math.max(t.values[1],i[1]),r[1]),e[2]=Math.min(Math.max(t.values[2],i[2]),r[2]),t.space[0]==="h"&&(e=fe.rgb(e)),e.push(Math.min(Math.max(t.alpha,0),1)),e}function et(n){return typeof n=="string"?n:it(n)}const Oi=1024,$={};let ge=0;function Ci(n){if($.hasOwnProperty(n))return $[n];if(ge>=Oi){let t=0;for(const i in $)t++&3||(delete $[i],--ge)}const e=ki(n);if(e.length!==4)throw new Error('Failed to parse "'+n+'" as color');for(const t of e)if(isNaN(t))throw new Error('Failed to parse "'+n+'" as color');return bi(e),$[n]=e,++ge,e}function tt(n){return Array.isArray(n)?n:Ci(n)}function bi(n){return n[0]=U(n[0]+.5|0,0,255),n[1]=U(n[1]+.5|0,0,255),n[2]=U(n[2]+.5|0,0,255),n[3]=U(n[3],0,1),n}function it(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*100)/100;return"rgba("+e+","+t+","+i+","+r+")"}function z(n){return Array.isArray(n)?it(n):n}function Z(n,e,t,i){let r;return t&&t.length?r=t.shift():Et?r=new OffscreenCanvas(n||300,e||300):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}const Fi="10px sans-serif",Q="#000",ee="round",nt=[],rt=0,te="round",de=10,_e="#000",st="center",Ii="middle",me=1;new De;class pe extends ue{constructor(e){const t=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:1,rotateWithView:t,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius_=e.radius!==void 0?e.radius:e.radius1,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.render()}clone(){const e=this.getScale(),t=new pe({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){let t=this.canvases_[e];if(!t){const i=this.renderOptions_,r=Z(i.size*e,i.size*e);this.draw_(i,r,e),t=r.canvas,this.canvases_[e]=t}return t}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return k.LOADED}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius_,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const L=r;r=s,s=L}const a=this.radius2_===void 0?this.points_:this.points_*2,o=2*Math.PI/a,l=s*Math.sin(o),h=Math.sqrt(s*s-l*l),f=r-h,u=Math.sqrt(l*l+f*f),c=u/l;if(e==="miter"&&c<=i)return c*t;const d=t/2/c,m=t/2*(f/u),p=Math.sqrt((r+d)*(r+d)+m*m)-r;if(this.radius2_===void 0||e==="bevel")return p*2;const v=r*Math.sin(o),w=Math.sqrt(r*r-v*v),x=s-w,T=Math.sqrt(v*v+x*x)/v;if(T<=i){const L=T*t/2-s-r;return 2*Math.max(p,L)}return p*2}createRenderOptions(){let e=ee,t=te,i=0,r=null,s=0,a,o=0;this.stroke_&&(a=z(this.stroke_.getColor()??_e),o=this.stroke_.getWidth()??me,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??te,e=this.stroke_.getLineCap()??ee,i=this.stroke_.getMiterLimit()??de);const l=this.calculateLineJoinSize_(t,o,i),h=Math.max(this.radius_,this.radius2_||0),f=Math.ceil(2*h+l);return{strokeStyle:a,strokeWidth:o,size:f,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=Q),t.fillStyle=z(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=tt(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=Z(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius_;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,a=2*Math.PI/t;for(let o=0;o<t;o++){const l=s+o*a,h=o%2===0?i:r;e.lineTo(h*Math.cos(l),h*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Q,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}}var at=pe;class ve extends at{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new ve({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius_=e,this.render()}}var Li=ve;class we{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null}clone(){const e=this.getColor();return new we({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){this.color_=e}}var ot=we;class ye{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new ye({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}var Mi=ye;class Se{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=lt,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Se({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=lt,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function lt(n){return n.getGeometry()}var Pi=Se;const Ti="#333";class xe{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=J(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new ot({color:Ti}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding}clone(){const e=this.getScale();return new xe({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=J(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}var Ei=xe;function Ai(n,e){return new Promise((t,i)=>{function r(){a(),t(n)}function s(){a(),i(new Error("Image load error"))}function a(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s),e&&(n.src=e)})}function Ri(n,e){return e&&(n.src=e),n.src&&At?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):Ai(n)}class Di{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];!(e++&3)&&!i.hasListener()&&(delete this.cache_[t],--this.cacheSize_)}}}get(e,t,i){const r=ht(e,t,i);return r in this.cache_?this.cache_[r]:null}set(e,t,i,r){const s=ht(e,t,i);this.cache_[s]=r,++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function ht(n,e,t){const i=t?et(t):"null";return e+":"+n+":"+i}const ct=new Di;let B=null;class zi extends Pe{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?k.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===k.LOADED){B||(B=Z(1,1,void 0,{willReadFrequently:!0})),B.drawImage(this.image_,0,0);try{B.getImageData(0,0,1,1),this.tainted_=!1}catch{B=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(X.CHANGE)}handleImageError_(){this.imageState_=k.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=k.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=Z(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===k.IDLE){this.image_||this.initializeImage_(),this.imageState_=k.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Ri(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==k.LOADED)return;const t=this.image_,i=document.createElement("canvas");i.width=Math.ceil(t.width*e),i.height=Math.ceil(t.height*e);const r=i.getContext("2d");r.scale(e,e),r.drawImage(t,0,0),r.globalCompositeOperation="multiply",r.fillStyle=et(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),this.canvas_[e]=i}}function Wi(n,e,t,i,r){let s=e===void 0?void 0:ct.get(e,t,r);return s||(s=new zi(n,n instanceof HTMLImageElement?n.src||void 0:e,t,i,r),ct.set(e,t,r,s)),s}function ut(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}class ke extends ue{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const a=e.img!==void 0?e.img:null;let o=e.src;se(!(o!==void 0&&a),"`image` and `src` cannot be provided at the same time"),(o===void 0||o.length===0)&&a&&(o=a.src||Ae(a)),se(o!==void 0&&o.length>0,"A defined and non-empty `src` or `image` must be provided"),se(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=k.IDLE:a!==void 0&&(a instanceof HTMLImageElement?a.complete?l=a.src?k.LOADED:k.IDLE:l=k.LOADING:l=k.LOADED),this.color_=e.color!==void 0?tt(e.color):null,this.iconImage_=Wi(a,o,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,e.width!==void 0||e.height!==void 0){let h,f;if(e.size)[h,f]=e.size;else{const u=this.getImage(1);if(u.width&&u.height)h=u.width,f=u.height;else if(u instanceof HTMLImageElement){this.initialOptions_=e;const c=()=>{if(this.unlistenImageChange(c),!this.initialOptions_)return;const d=this.iconImage_.getSize();this.setScale(ut(d[0],d[1],e.width,e.height))};this.listenImageChange(c);return}}h!==void 0&&this.setScale(ut(h,f,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new ke({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==k.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==k.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(X.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(X.CHANGE,e)}}var qi=ke;const ft={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Oe=/^ttf:\/\/(.+)#(.+)$/,gt="geostyler-mark-symbolizer";class g{static getRgbaColor(e,t){if(W(e)&&(e=g.evaluateStringFunction(e)),typeof e!="string")return;if(e.startsWith("rgba("))return e;if(!/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e))return;const r=parseInt(e.slice(1,3),16),s=parseInt(e.slice(3,5),16),a=parseInt(e.slice(5,7),16);return ie(t)&&(t=g.evaluateNumberFunction(t)),t<0&&(t=1),"rgba("+r+", "+s+", "+a+", "+t+")"}static splitRgbaColor(e){const t=e.substring(e.indexOf("(")+1,e.lastIndexOf(")")).split(/,\s*/),i=parseInt(t[0],10),r=parseInt(t[1],10),s=parseInt(t[2],10),a=parseFloat(t[3]);return[i,r,s,a]}static getHexColor(e){if(e.startsWith("#"))return e;if(e.startsWith("rgb")){const t=g.splitRgbaColor(e);return g.getHexCodeFromRgbArray(t)}else if(ft[e.toLocaleLowerCase()]!==void 0){const t=ft[e.toLocaleLowerCase()];return g.getHexCodeFromRgbArray(t)}else return}static getHexCodeFromRgbArray(e){return"#"+e.map((t,i)=>{const r=t.toString(16);return i<3?r.length===1?"0"+r:r:""}).join("")}static getOpacity(e){if(!e.startsWith("rgba("))return;const t=g.splitRgbaColor(e);if(t.length===4)return t[3]}static getTextFont(e){const t=e.fontWeight??"normal",i=e.fontStyle??"normal",r=e.size,s=e.font;return t+" "+i+" "+r+"px "+(s==null?void 0:s.join(", "))}static getIsFontGlyphBased(e){return Oe.test(e.wellKnownName)}static getIsMarkSymbolizerFont(e){if(!e)return!1;const t=gt;return e.substring(e.length-t.length,e.length)===t}static getTextFontForMarkSymbolizer(e){const t=e.wellKnownName.match(Oe);if(!t)throw new Error(`Could not parse font-based well known name: ${e.wellKnownName}`);const i=t[1];return`Normal ${e.radius||5}px '${i}', ${gt}`}static getCharacterForMarkSymbolizer(e){const t=e.wellKnownName.match(Oe);if(!t)throw new Error(`Could not parse font-based well known name: ${e.wellKnownName}`);return String.fromCharCode(parseInt(t[2],16))}static getFontNameFromOlFont(e){const t=e.match(/(?:\d+\S+) '?"?([^,'"]+)/);if(!t)throw new Error(`Could not find font family name in the following string: ${e}`);return t[1]}static getSizeFromOlFont(e){const t=e.match(/(?:(\d+)px)/);return t?parseInt(t[1],10):0}static resolveAttributeTemplate(e,t,i="n.v.",r=(s,a)=>a){let s="\\{\\{",a="\\}\\}",o=new RegExp(s+"(.*?)"+a,"g"),l=t.match(o);return l&&l.forEach(h=>{let f=0;for(let[u,c]of Object.entries(e.getProperties()))if(h.slice(2,h.length-2).toLowerCase()===u.toLowerCase()){t=t.replace(h,r(u,c));break}else f++;f===Object.keys(e.getProperties()).length&&(t=t.replace(h,i))}),t}static evaluateFunction(e,t){if(e.name==="property"){if(!t)throw new Error(`Could not evalute 'property' function. Feature ${t} is not defined.`);return W(e.args[0])?t==null?void 0:t.get(g.evaluateStringFunction(e.args[0],t)):t==null?void 0:t.get(e.args[0])}if(be(e))return g.evaluateUnknownFunction(e,t);if(W(e))return g.evaluateStringFunction(e,t);if(ie(e))return g.evaluateNumberFunction(e,t);if(j(e))return g.evaluateBooleanFunction(e,t)}static evaluateBooleanFunction(e,t){const i=e.args.map(r=>S(r)?g.evaluateFunction(r,t):r);switch(e.name){case"all":return i.map(a=>this.evaluateBooleanFunction(a,t)).every(a=>a===!0);case"any":return i.map(a=>this.evaluateBooleanFunction(a,t)).some(a=>a===!0);case"between":return i[0]>=i[1]&&i[0]<=i[2];case"double2bool":return!1;case"equalTo":return i[0]===i[1];case"greaterThan":return i[0]>i[1];case"greaterThanOrEqualTo":return i[0]>=i[1];case"in":return i.slice(1).includes(i[0]);case"lessThan":return i[0]<i[1];case"lessThanOrEqualTo":return i[0]<=i[1];case"not":return!i[0];case"notEqualTo":return i[0]!==i[1];case"parseBoolean":return!!i[0];case"strEndsWith":return i[0].endsWith(i[1]);case"strEqualsIgnoreCase":return i[0].toLowerCase()===i[1].toLowerCase();case"strMatches":const s=i[1].match(/\/(.*?)\/([gimy]{0,4})$/);return s&&s.length===3?new RegExp(s[1],s[2]).test(i[0]):!1;case"strStartsWith":return i[0].startsWith(i[1]);default:return!1}}static evaluateNumberFunction(e,t){if(e.name==="pi")return Math.PI;if(e.name==="random")return Math.random();const i=e.args.map(r=>S(r)?g.evaluateFunction(r,t):r);switch(e.name){case"abs":return Math.abs(i[0]);case"acos":return Math.acos(i[0]);case"add":return i[0]+i[1];case"asin":return Math.asin(i[0]);case"atan":return Math.atan(i[0]);case"atan2":return i[0];case"ceil":return Math.ceil(i[0]);case"cos":return Math.cos(i[0]);case"div":return i[0]/i[1];case"exp":return Math.exp(i[0]);case"floor":return Math.floor(i[0]);case"log":return Math.log(i[0]);case"max":return Math.max(...i);case"min":return Math.min(...i);case"modulo":return i[0]%i[1];case"mul":return i[0]*i[1];case"pow":return Math.pow(i[0],i[1]);case"rint":return i[0];case"round":return Math.round(i[0]);case"sin":return Math.sin(i[0]);case"sqrt":return Math.sqrt(i[0]);case"strIndexOf":return i[0].indexOf(i[1]);case"strLastIndexOf":return i[0].lastIndexOf(i[1]);case"strLength":return i[0].length;case"sub":return i[0]-i[1];case"tan":return Math.tan(i[0]);case"toDegrees":return i[0]*(180/Math.PI);case"toRadians":return i[0]*(Math.PI/180);default:return i[0]}}static evaluateUnknownFunction(e,t){const i=e.args.map(r=>S(r)?g.evaluateFunction(r,t):r);switch(e.name){case"property":return t==null?void 0:t.get(i[0]);case"case":const r=i;let s;for(let a=0;a<r.length;a++){const o=r[a];if(a===r.length-1){s=o;break}else if(o.case===!0){s=o.value;break}else if(g.evaluateBooleanFunction(o.case,t)){s=o.value;break}}return s;default:return i[0]}}static evaluateStringFunction(e,t){var s;const i=e.args.map(a=>S(a)?g.evaluateFunction(a,t):a);switch(e.name){case"numberFormat":return i[0];case"strAbbreviate":return i[0];case"strCapitalize":var r=i[0].toLowerCase().split(" ");for(let a of r)a=a.charAt(0).toUpperCase()+a.substring(1);return r.join(" ");case"strConcat":return i.join();case"strDefaultIfBlank":return((s=i[0])==null?void 0:s.length)<1?i[1]:i[0];case"strReplace":return i[3]===!0?i[0].replaceAll(i[1],i[2]):i[0].replace(i[1],i[2]);case"strStripAccents":return i[0].normalize("NFKD").replace(/[\u0300-\u036f]/g,"");case"strSubstring":return i[0].substring(i[1],i[2]);case"strSubstringStart":return i[0].substring(i[1]);case"strToLowerCase":return i[0].toLowerCase();case"strToUpperCase":return i[0].toUpperCase();case"strTrim":return i[0].trim();default:return i[0]}}static containsGeoStylerFunctions(e){return e.rules.some(t=>{var a,o,l,h;const i=Array.isArray(t.filter)&&((a=t.filter)==null?void 0:a.some(S)),r=(o=t.symbolizers)==null?void 0:o.some(f=>Object.values(f).some(S)),s=S((l=t==null?void 0:t.scaleDenominator)==null?void 0:l.max)||S((h=t==null?void 0:t.scaleDenominator)==null?void 0:h.min);return i||r||s})}}class Gi{drawCustom(e,t,i,r){}drawGeometry(e){}setStyle(e){}drawCircle(e,t){}drawFeature(e,t){}drawGeometryCollection(e,t){}drawLineString(e,t){}drawMultiLineString(e,t){}drawMultiPoint(e,t){}drawMultiPolygon(e,t){}drawPoint(e,t){}drawPolygon(e,t){}drawText(e,t){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}var Ni=Gi;class $i extends Ni{constructor(e,t,i,r,s,a,o){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?ri(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=a,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=ae()}drawImages_(e,t,i,r){if(!this.image_)return;const s=N(e,t,i,r,this.transform_,this.pixelCoordinates_),a=this.context_,o=this.tmpLocalTransform_,l=a.globalAlpha;this.imageOpacity_!=1&&(a.globalAlpha=l*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let f=0,u=s.length;f<u;f+=2){const c=s[f]-this.imageAnchorX_,d=s[f+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const m=c+this.imageAnchorX_,_=d+this.imageAnchorY_;ze(o,m,_,1,1,h,-m,-_),a.save(),a.transform.apply(a,o),a.translate(m,_),a.scale(this.imageScale_[0],this.imageScale_[1]),a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),a.restore()}else a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,c,d,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(a.globalAlpha=l)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=N(e,t,i,r,this.transform_,this.pixelCoordinates_),a=this.context_;let o=this.textRotation_;for(this.transformRotation_===0&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);t<i;t+=r){const l=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;o!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(a.save(),a.translate(l-this.textOffsetX_,h-this.textOffsetY_),a.rotate(o),a.translate(this.textOffsetX_,this.textOffsetY_),a.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&a.strokeText(this.text_,0,0),this.textFillState_&&a.fillText(this.text_,0,0),a.restore()):(this.textStrokeState_&&a.strokeText(this.text_,l,h),this.textFillState_&&a.fillText(this.text_,l,h))}}moveToLineTo_(e,t,i,r,s){const a=this.context_,o=N(e,t,i,r,this.transform_,this.pixelCoordinates_);a.moveTo(o[0],o[1]);let l=o.length;s&&(l-=2);for(let h=2;h<l;h+=2)a.lineTo(o[h],o[h+1]);return s&&a.closePath(),i}drawRings_(e,t,i,r){for(let s=0,a=i.length;s<a;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!q(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=vi(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),a=this.context_;a.beginPath(),a.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!q(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(q(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const a=e.getEnds(),o=e.getStride();i.beginPath();for(let l=0,h=a.length;l<h;++l)s=this.moveToLineTo_(r,s,a[l],o,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!q(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!q(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),a=e.getStride();t.beginPath();for(let o=0,l=s.length;o<l;++o){const h=s[o];r=this.drawRings_(i,r,h,a)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),Ie(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:st;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:z(i||Q)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),a=t.getLineDashOffset(),o=t.getLineJoin(),l=t.getWidth(),h=t.getMiterLimit(),f=s||nt;this.strokeState_={lineCap:r!==void 0?r:ee,lineDash:this.pixelRatio_===1?f:f.map(u=>u*this.pixelRatio_),lineDashOffset:(a||rt)*this.pixelRatio_,lineJoin:o!==void 0?o:te,lineWidth:(l!==void 0?l:me)*this.pixelRatio_,miterLimit:h!==void 0?h:de,strokeStyle:z(i||_e)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const a=e.getScaleArray();this.imageScale_=[a[0]*this.pixelRatio_/i,a[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const d=t.getColor();this.textFillState_={fillStyle:z(d||Q)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const d=i.getColor(),m=i.getLineCap(),_=i.getLineDash(),p=i.getLineDashOffset(),v=i.getLineJoin(),w=i.getWidth(),x=i.getMiterLimit();this.textStrokeState_={lineCap:m!==void 0?m:ee,lineDash:_||nt,lineDashOffset:p||rt,lineJoin:v!==void 0?v:te,lineWidth:w!==void 0?w:me,miterLimit:x!==void 0?x:de,strokeStyle:z(d||_e)}}const r=e.getFont(),s=e.getOffsetX(),a=e.getOffsetY(),o=e.getRotateWithView(),l=e.getRotation(),h=e.getScaleArray(),f=e.getText(),u=e.getTextAlign(),c=e.getTextBaseline();this.textState_={font:r!==void 0?r:Fi,textAlign:u!==void 0?u:st,textBaseline:c!==void 0?c:Ii},this.text_=f!==void 0?Array.isArray(f)?f.reduce((d,m,_)=>d+=_%2?" ":m,""):f:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=a!==void 0?this.pixelRatio_*a:0,this.textRotateWithView_=o!==void 0?o:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}var Bi=$i;function ji(n,e){const t=n.canvas;e=e||{};const i=e.pixelRatio||Tt,r=e.size;r&&(t.width=r[0]*i,t.height=r[1]*i,t.style.width=r[0]+"px",t.style.height=r[1]+"px");const s=[0,0,t.width,t.height],a=Wt(ae(),i,i);return new Bi(n,i,s,a,0)}const dt=Object.assign({"./svg/arrow.svg":()=>Promise.resolve().then(function(){return Yi}).then(n=>n.default),"./svg/arrowhead.svg":()=>Promise.resolve().then(function(){return Hi}).then(n=>n.default),"./svg/asterisk_fill.svg":()=>Promise.resolve().then(function(){return Ji}).then(n=>n.default),"./svg/circle.svg":()=>Promise.resolve().then(function(){return Zi}).then(n=>n.default),"./svg/cross.svg":()=>Promise.resolve().then(function(){return en}).then(n=>n.default),"./svg/cross2.svg":()=>Promise.resolve().then(function(){return nn}).then(n=>n.default),"./svg/cross_fill.svg":()=>Promise.resolve().then(function(){return sn}).then(n=>n.default),"./svg/decagon.svg":()=>Promise.resolve().then(function(){return on}).then(n=>n.default),"./svg/diagonal_half_square.svg":()=>Promise.resolve().then(function(){return hn}).then(n=>n.default),"./svg/diamond.svg":()=>Promise.resolve().then(function(){return un}).then(n=>n.default),"./svg/equilateral_triangle.svg":()=>Promise.resolve().then(function(){return gn}).then(n=>n.default),"./svg/filled_arrowhead.svg":()=>Promise.resolve().then(function(){return _n}).then(n=>n.default),"./svg/half_arc.svg":()=>Promise.resolve().then(function(){return pn}).then(n=>n.default),"./svg/half_square.svg":()=>Promise.resolve().then(function(){return wn}).then(n=>n.default),"./svg/heart.svg":()=>Promise.resolve().then(function(){return Sn}).then(n=>n.default),"./svg/hexagon.svg":()=>Promise.resolve().then(function(){return kn}).then(n=>n.default),"./svg/left_half_triangle.svg":()=>Promise.resolve().then(function(){return Cn}).then(n=>n.default),"./svg/line.svg":()=>Promise.resolve().then(function(){return Fn}).then(n=>n.default),"./svg/octagon.svg":()=>Promise.resolve().then(function(){return Ln}).then(n=>n.default),"./svg/parallelogram_left.svg":()=>Promise.resolve().then(function(){return Pn}).then(n=>n.default),"./svg/parallelogram_right.svg":()=>Promise.resolve().then(function(){return En}).then(n=>n.default),"./svg/pentagon.svg":()=>Promise.resolve().then(function(){return Rn}).then(n=>n.default),"./svg/quarter_arc.svg":()=>Promise.resolve().then(function(){return zn}).then(n=>n.default),"./svg/quarter_circle.svg":()=>Promise.resolve().then(function(){return qn}).then(n=>n.default),"./svg/quarter_square.svg":()=>Promise.resolve().then(function(){return Nn}).then(n=>n.default),"./svg/right_half_triangle.svg":()=>Promise.resolve().then(function(){return Bn}).then(n=>n.default),"./svg/rounded_square.svg":()=>Promise.resolve().then(function(){return Xn}).then(n=>n.default),"./svg/semi_circle.svg":()=>Promise.resolve().then(function(){return Vn}).then(n=>n.default),"./svg/shield.svg":()=>Promise.resolve().then(function(){return Un}).then(n=>n.default),"./svg/square.svg":()=>Promise.resolve().then(function(){return Kn}).then(n=>n.default),"./svg/square_with_corners.svg":()=>Promise.resolve().then(function(){return Qn}).then(n=>n.default),"./svg/star.svg":()=>Promise.resolve().then(function(){return tr}).then(n=>n.default),"./svg/star_diamond.svg":()=>Promise.resolve().then(function(){return nr}).then(n=>n.default),"./svg/third_arc.svg":()=>Promise.resolve().then(function(){return sr}).then(n=>n.default),"./svg/third_circle.svg":()=>Promise.resolve().then(function(){return or}).then(n=>n.default),"./svg/trapezoid.svg":()=>Promise.resolve().then(function(){return hr}).then(n=>n.default),"./svg/triangle.svg":()=>Promise.resolve().then(function(){return ur}).then(n=>n.default)}),_t=async n=>{const e=`./svg/${n}.svg`;if(e in dt)return await dt[e]();throw new Error(`SVG file ${n} not found.`)};class Ce{constructor(e){C(this,"unsupportedProperties",{Symbolizer:{MarkSymbolizer:{avoidEdges:"none",blur:"none",offsetAnchor:"none",pitchAlignment:"none",pitchScale:"none"},FillSymbolizer:{antialias:"none",opacity:{support:"none",info:"Use fillOpacity instead."}},IconSymbolizer:{allowOverlap:"none",anchor:"none",avoidEdges:"none",color:"none",haloBlur:"none",haloColor:"none",haloWidth:"none",keepUpright:"none",offsetAnchor:"none",size:{support:"partial",info:"Will set/get the width of the ol Icon."},optional:"none",padding:"none",pitchAlignment:"none",rotationAlignment:"none",textFit:"none",textFitPadding:"none"},LineSymbolizer:{blur:"none",gapWidth:"none",gradient:"none",miterLimit:"none",roundLimit:"none",spacing:"none",graphicFill:"none",graphicStroke:"none",perpendicularOffset:"none"},RasterSymbolizer:"none",TextSymbolizer:{anchor:"none",placement:{support:"partial",info:"point and line supported. line-center will be mapped to line."}}},Function:{double2bool:{support:"none",info:"Always returns false"},atan2:{support:"none",info:"Currently returns the first argument"},rint:{support:"none",info:"Currently returns the first argument"},numberFormat:{support:"none",info:"Currently returns the first argument"},strAbbreviate:{support:"none",info:"Currently returns the first argument"}}});C(this,"title","OpenLayers Style Parser");C(this,"olIconStyleCache",{});C(this,"OlStyleConstructor",Pi);C(this,"OlStyleImageConstructor",ue);C(this,"OlStyleFillConstructor",ot);C(this,"OlStyleStrokeConstructor",Mi);C(this,"OlStyleTextConstructor",Ei);C(this,"OlStyleCircleConstructor",Li);C(this,"OlStyleIconConstructor",qi);C(this,"OlStyleRegularshapeConstructor",at);C(this,"isOlParserStyleFct",e=>typeof e=="function");e&&(this.OlStyleConstructor=e.style.Style,this.OlStyleImageConstructor=e.style.Image,this.OlStyleFillConstructor=e.style.Fill,this.OlStyleStrokeConstructor=e.style.Stroke,this.OlStyleTextConstructor=e.style.Text,this.OlStyleCircleConstructor=e.style.Circle,this.OlStyleIconConstructor=e.style.Icon,this.OlStyleRegularshapeConstructor=e.style.RegularShape)}getPointSymbolizerFromOlStyle(e){let t;if(e.getImage()instanceof this.OlStyleCircleConstructor){const i=e.getImage(),r=i.getFill(),s=i.getStroke(),a=i.getDisplacement();t={kind:"Mark",wellKnownName:"circle",color:r?g.getHexColor(r.getColor()):void 0,opacity:i.getOpacity()!==1?i.getOpacity():void 0,fillOpacity:r?g.getOpacity(r.getColor()):void 0,radius:i.getRadius()!==0?i.getRadius():5,strokeColor:s?s.getColor():void 0,strokeOpacity:s?g.getOpacity(s.getColor()):void 0,strokeWidth:s?s.getWidth():void 0,offset:a[0]||a[1]?a:void 0}}else if(e.getImage()instanceof this.OlStyleRegularshapeConstructor){const i=e.getImage(),r=i.getFill(),s=i.getStroke(),a=i.getRadius(),o=i.getRadius2(),l=i.getPoints(),h=i.getAngle(),f=i.getDisplacement(),u={kind:"Mark",color:r?g.getHexColor(r.getColor()):void 0,opacity:i.getOpacity()!==1?i.getOpacity():void 0,fillOpacity:r?g.getOpacity(r.getColor()):void 0,strokeColor:s?s.getColor():void 0,strokeOpacity:s?g.getOpacity(s.getColor()):void 0,strokeWidth:s?s.getWidth():void 0,radius:a!==0?a:5,rotate:i.getRotation()/Math.PI*180,offset:f[0]||f[1]?f:void 0};switch(l){case 2:switch(h){case 0:u.wellKnownName="shape://vertline";break;case Math.PI/2:u.wellKnownName="shape://horline";break;case Math.PI/4:u.wellKnownName="shape://slash";break;case 2*Math.PI-Math.PI/4:u.wellKnownName="shape://backslash";break}break;case 3:switch(h){case 0:u.wellKnownName="triangle";break;case Math.PI/2:u.wellKnownName="shape://carrow";break}break;case 4:Number.isFinite(o)?i.getAngle()===0?u.wellKnownName="cross":u.wellKnownName="x":u.wellKnownName="square";break;case 5:u.wellKnownName="star";break;default:throw new Error("Could not parse OlStyle. Only 2, 3, 4 or 5 point regular shapes are allowed")}t=u}else if(e.getText()instanceof this.OlStyleTextConstructor){const i=e.getText(),r=i.getFill(),s=i.getStroke(),a=i.getRotation();let o=i.getText()||"a";const l=i.getFont()||"10px sans-serif",h=g.getFontNameFromOlFont(l),f=g.getSizeFromOlFont(l),u=[i.getOffsetX(),i.getOffsetY()];Array.isArray(o)&&(o=o[0]),t={kind:"Mark",wellKnownName:`ttf://${h}#0x${o.charCodeAt(0).toString(16)}`,color:r?g.getHexColor(r.getColor()):void 0,opacity:r?g.getOpacity(r.getColor()):void 0,strokeColor:s?s.getColor():void 0,strokeOpacity:s?g.getOpacity(s.getColor()):void 0,strokeWidth:s?s.getWidth():void 0,radius:f!==0?f:5,rotate:a?a/Math.PI*180:0,offset:u[0]||u[1]?u:void 0}}else{const i=e.getImage(),r=i.getDisplacement(),s=this.getImageFromIconStyle(i);let a=i.getWidth();const o=i.getRotation()/Math.PI*180,l=i.getOpacity();t={kind:"Icon",image:s,opacity:l<1?l:void 0,size:a,rotate:o!==0?o:void 0,offset:r[0]||r[1]?r:void 0}}return t}getImageFromIconStyle(e){const t=e.getSize();if(Array.isArray(t)){let i=e.offset_;const r=e.offsetOrigin_;if(r&&r!=="top-left")throw new Error(`Offset origin ${r} not supported`);return{source:e.getSrc(),position:i,size:t}}else return e.getSrc()?e.getSrc():void 0}getLineSymbolizerFromOlStyle(e){const t=e.getStroke(),i=t?t.getLineDash():void 0;return{kind:"Line",color:t?g.getHexColor(t.getColor()):void 0,opacity:t?g.getOpacity(t.getColor()):void 0,width:t?t.getWidth():void 0,cap:t?t.getLineCap():"butt",join:t?t.getLineJoin():"miter",dasharray:i||void 0,dashOffset:t?t.getLineDashOffset():void 0}}getFillSymbolizerFromOlStyle(e){const t=e.getFill(),i=e.getStroke(),r=i?i.getLineDash():void 0,s={kind:"Fill"};return t&&(s.color=g.getHexColor(t.getColor())),t&&(s.fillOpacity=g.getOpacity(t.getColor())),i&&(s.outlineColor=g.getHexColor(i.getColor())),r&&(s.outlineDasharray=r),i&&(s.outlineOpacity=g.getOpacity(i.getColor())),i&&i.getWidth()&&(s.outlineWidth=i.getWidth()),s}getTextSymbolizerFromOlStyle(e){const t=e.getText();if(!t)throw new Error("Could not get text from olStyle.");const i=t.getFill(),r=t.getStroke(),s=t.getOffsetX(),a=t.getOffsetY(),o=t.getFont(),l=t.getRotation(),h=t.getOverflow()?t.getOverflow():void 0,f=t.getPlacement(),u=t.getText(),c=Array.isArray(u)?u[0]:u;let d=1/0,m,_,p;if(o){const v=pt(o);if(v["font-weight"]&&(_=v["font-weight"]),v["font-size"]&&(d=parseInt(v["font-size"],10)),v["font-family"]){const w=v["font-family"];m=w==null?void 0:w.map(x=>x.includes(" ")?'"'+x+'"':x)}v["font-style"]&&(p=v["font-style"])}return{kind:"Text",label:c,placement:f,allowOverlap:h,color:i?g.getHexColor(i.getColor()):void 0,size:isFinite(d)?d:void 0,font:m,fontWeight:_||void 0,fontStyle:p||void 0,offset:s!==void 0&&a!==void 0?[s,a]:[0,0],haloColor:r&&r.getColor()?g.getHexColor(r.getColor()):void 0,haloWidth:r?r.getWidth():void 0,rotate:l!==void 0?l/Math.PI*180:void 0}}getSymbolizersFromOlStyle(e){const t=[];return e.forEach(i=>{let r;switch(this.getStyleTypeFromOlStyle(i)){case"Point":i.getText()&&!g.getIsMarkSymbolizerFont(i.getText().getFont())?r=this.getTextSymbolizerFromOlStyle(i):r=this.getPointSymbolizerFromOlStyle(i);break;case"Line":r=this.getLineSymbolizerFromOlStyle(i);break;case"Fill":r=this.getFillSymbolizerFromOlStyle(i);break;default:throw new Error("Failed to parse SymbolizerKind from OpenLayers Style")}t.push(r)}),t}getRuleFromOlStyle(e){let t;const i="OL Style Rule 0";return Array.isArray(e)?t=this.getSymbolizersFromOlStyle(e):t=this.getSymbolizersFromOlStyle([e]),{name:i,symbolizers:t}}getStyleTypeFromOlStyle(e){let t;if(e.getImage()instanceof this.OlStyleImageConstructor)t="Point";else if(e.getText()instanceof this.OlStyleTextConstructor)t="Point";else if(e.getFill()instanceof this.OlStyleFillConstructor)t="Fill";else if(e.getStroke()&&!e.getFill())t="Line";else throw new Error("StyleType could not be detected");return t}olStyleToGeoStylerStyle(e){const t="OL Style",i=this.getRuleFromOlStyle(e);return{name:t,rules:[i]}}readStyle(e){return new Promise(t=>{try{if(this.isOlParserStyleFct(e))t({output:e.__geoStylerStyle});else{e=e;const i=this.olStyleToGeoStylerStyle(e),r=this.checkForUnsupportedProperties(i);t({output:i,unsupportedProperties:r})}}catch(i){t({errors:[i]})}})}writeStyle(e){return new Promise(t=>{const i=structuredClone(e),r=this.checkForUnsupportedProperties(i);try{const s=this.getOlStyleTypeFromGeoStylerStyle(i);t({output:s,unsupportedProperties:r,warnings:r&&["Your style contains unsupportedProperties!"]})}catch(s){t({errors:[s]})}})}checkForUnsupportedProperties(e){const t=r=>r[0].toUpperCase()+r.slice(1),i={};if(e.rules.forEach(r=>{r.symbolizers.forEach(s=>{var l,h;const a=t(`${s.kind}Symbolizer`),o=(h=(l=this.unsupportedProperties)==null?void 0:l.Symbolizer)==null?void 0:h[a];o&&(typeof o=="string"?(i.Symbolizer||(i.Symbolizer={}),i.Symbolizer[a]=o):Object.keys(s).forEach(f=>{o[f]&&(i.Symbolizer||(i.Symbolizer={}),i.Symbolizer[a]||(i.Symbolizer[a]={}),i.Symbolizer[a][f]=o[f])}))})}),Object.keys(i).length>0)return i}getOlStyleTypeFromGeoStylerStyle(e){var r,s,a,o,l,h,f,u;const t=e.rules;if(t.length===1){const c=((s=(r=e==null?void 0:e.rules)==null?void 0:r[0])==null?void 0:s.filter)!==void 0,d=((l=(o=(a=e==null?void 0:e.rules)==null?void 0:a[0])==null?void 0:o.scaleDenominator)==null?void 0:l.min)!==void 0,m=((u=(f=(h=e==null?void 0:e.rules)==null?void 0:h[0])==null?void 0:f.scaleDenominator)==null?void 0:u.max)!==void 0,_=!!(d||m),p=g.containsGeoStylerFunctions(e),v=e.rules[0].symbolizers.length,w=t[0].symbolizers.some(F=>F.kind==="Text"),x=t[0].symbolizers.some(F=>F.kind==="Icon"&&typeof F.image=="string"&&F.image.includes("{{"));return!c&&!_&&!w&&!x&&!p?v===1?this.geoStylerStyleToOlStyle(e):this.geoStylerStyleToOlStyleArray(e):this.geoStylerStyleToOlParserStyleFct(e)}else return this.geoStylerStyleToOlParserStyleFct(e)}geoStylerStyleToOlStyle(e){const i=e.rules[0].symbolizers[0];return this.getOlSymbolizerFromSymbolizer(i)}geoStylerStyleToOlStyleArray(e){const t=e.rules[0],i=[];return t.symbolizers.forEach(r=>{const s=this.getOlSymbolizerFromSymbolizer(r);i.push(s)}),i}geoStylerStyleToOlParserStyleFct(e){const t=structuredClone(e.rules),r=(s,a)=>{const o=[],l=90.7142857142857,h=Ne.m,f=39.37,u=a*h*f*l;return t.forEach(c=>{var v,w;let d=(v=c==null?void 0:c.scaleDenominator)==null?void 0:v.min,m=(w=c==null?void 0:c.scaleDenominator)==null?void 0:w.max,_=!0;(d||m)&&(d=S(d)?g.evaluateNumberFunction(d):d,m=S(m)?g.evaluateNumberFunction(m):m,d&&u<d&&(_=!1),m&&u>=m&&(_=!1));let p=!1;if(!c.filter)p=!0;else try{p=this.geoStylerFilterToOlParserFilter(s,c.filter)}catch{p=!1}_&&p&&c.symbolizers.forEach(x=>{x.visibility===!1&&o.push(null),j(x.visibility)&&(g.evaluateBooleanFunction(x.visibility)||o.push(null));const F=this.getOlSymbolizerFromSymbolizer(x,s);if(typeof F!="function")o.push(F);else{const T=F(s,a);o.push(T)}})}),o};return r.__geoStylerStyle=e,r}geoStylerFilterToOlParserFilter(e,t){const i={"&&":!0,"||":!0,"!":!0};let r=!0;if(j(t))return g.evaluateBooleanFunction(t,e);if(t===!0||t===!1)return t;const s=t[0];let a=!1;i[s]&&(a=!0);try{if(a){let o,l;switch(t[0]){case"&&":o=!0,l=t.slice(1),l.forEach(h=>{this.geoStylerFilterToOlParserFilter(e,h)||(o=!1)}),r=o;break;case"||":o=!1,l=t.slice(1),l.forEach(h=>{this.geoStylerFilterToOlParserFilter(e,h)&&(o=!0)}),r=o;break;case"!":r=!this.geoStylerFilterToOlParserFilter(e,t[1]);break;default:throw new Error("Cannot parse Filter. Unknown combination or negation operator.")}}else{let o;S(t[1])?o=g.evaluateFunction(t[1],e):o=e.get(t[1]);let l;switch(S(t[2])?l=g.evaluateFunction(t[2],e):l=t[2],t[0]){case"==":r=""+o==""+l;break;case"*=":typeof l=="string"&&typeof o=="string"&&(l.length>o.length?r=!1:r=o.indexOf(l)!==-1);break;case"!=":r=""+o!=""+l;break;case"<":r=Number(o)<Number(l);break;case"<=":r=Number(o)<=Number(l);break;case">":r=Number(o)>Number(l);break;case">=":r=Number(o)>=Number(l);break;default:throw new Error("Cannot parse Filter. Unknown comparison operator.")}}}catch{throw new Error("Cannot parse Filter. Invalid structure.")}return r}getOlSymbolizerFromSymbolizer(e,t){let i;switch(e=structuredClone(e),e.kind){case"Mark":i=this.getOlPointSymbolizerFromMarkSymbolizer(e,t);break;case"Icon":i=this.getOlIconSymbolizerFromIconSymbolizer(e,t);break;case"Text":i=this.getOlTextSymbolizerFromTextSymbolizer(e,t);break;case"Line":i=this.getOlLineSymbolizerFromLineSymbolizer(e,t);break;case"Fill":i=this.getOlPolygonSymbolizerFromFillSymbolizer(e,t);break;default:const r=new this.OlStyleFillConstructor({color:"rgba(255,255,255,0.4)"}),s=new this.OlStyleStrokeConstructor({color:"#3399CC",width:1.25});i=new this.OlStyleConstructor({image:new this.OlStyleCircleConstructor({fill:r,stroke:s,radius:5}),fill:r,stroke:s});break}return i}getOlPointSymbolizerFromMarkSymbolizer(e,t){let i;for(const w of Object.keys(e))S(e[w])&&(e[w]=g.evaluateFunction(e[w],t));const r=e.strokeColor,s=e.strokeOpacity,a=e.strokeWidth===void 0?1:e.strokeWidth,o=r&&s!==void 0?g.getRgbaColor(r,s):e.strokeColor;(e.strokeColor||e.strokeWidth!==void 0)&&(i=new this.OlStyleStrokeConstructor({color:o,width:e.strokeWidth}));const l=e.color,h=e.opacity,f=e.radius,u=((e==null?void 0:e.radius)??8)*2,c=e.fillOpacity,d=l&&c!==void 0?g.getRgbaColor(l,c??1):l,m=new this.OlStyleFillConstructor({color:d});let _;const p={fill:m,radius:f??5,rotation:typeof e.rotate=="number"?e.rotate*Math.PI/180:void 0,stroke:i,displacement:Array.isArray(e.offset)?e.offset.map(Number):void 0};let v=e.wellKnownName;switch(v=v==="shape://dot"?"circle":v,v=v==="shape://plus"?"cross":v,v){case"arrow":case"arrowhead":case"asterisk_fill":case"circle":case"cross":case"cross2":case"cross_fill":case"decagon":case"diagonal_half_square":case"diamond":case"equilateral_triangle":case"filled_arrowhead":case"half_arc":case"half_square":case"heart":case"hexagon":case"left_half_triangle":case"line":case"octagon":case"parallelogram_left":case"parallelogram_right":case"pentagon":case"quarter_arc":case"quarter_circle":case"quarter_square":case"right_half_triangle":case"rounded_square":case"semi_circle":case"shield":case"square":case"square_with_corners":case"star":case"star_diamond":case"third_arc":case"third_circle":case"trapezoid":case"triangle":_t(v).then(w=>{const T=new DOMParser().parseFromString(w,"image/svg+xml").documentElement,L=(gr,dr,_r)=>{T.querySelectorAll(gr).forEach(mr=>mr.setAttribute(dr,_r))};L("[fill]","fill",String(d)),L("[stroke]","stroke",String(o)),L("[stroke-width]","stroke-width",String(a)),L("[width]","width",String(u)),L("[height]","height",String(u));const fr=new XMLSerializer().serializeToString(T);_=new this.OlStyleConstructor({image:new this.OlStyleIconConstructor({src:`data:image/svg+xml;base64,${btoa(fr)}`,scale:1})})}).catch(()=>{throw new Error(`No SVG for WellKnownName (${v}.)`)});break;case"shape://times":case"x":p.stroke===void 0&&(p.stroke=new this.OlStyleStrokeConstructor({color:"#000"})),_=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor({...p,points:4,radius2:0,angle:45*Math.PI/180})});break;case"shape://backslash":p.stroke===void 0&&(p.stroke=new this.OlStyleStrokeConstructor({color:"#000"})),_=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor({...p,points:2,angle:2*Math.PI-Math.PI/4})});break;case"shape://horline":p.stroke===void 0&&(p.stroke=new this.OlStyleStrokeConstructor({color:"#000"})),_=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor({...p,points:2,angle:Math.PI/2})});break;case"shape://oarrow":case"shape://carrow":_=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor({...p,points:3,angle:Math.PI/2})});break;case"shape://slash":p.stroke===void 0&&(p.stroke=new this.OlStyleStrokeConstructor({color:"#000"})),_=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor({...p,points:2,angle:Math.PI/4})});break;case"shape://vertline":p.stroke===void 0&&(p.stroke=new this.OlStyleStrokeConstructor({color:"#000"})),_=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor({...p,points:2,angle:0})});break;default:if(g.getIsFontGlyphBased(e)){_=new this.OlStyleConstructor({text:new this.OlStyleTextConstructor({text:g.getCharacterForMarkSymbolizer(e),font:g.getTextFontForMarkSymbolizer(e),fill:p.fill,stroke:p.stroke,rotation:p.rotation})});break}throw new Error("MarkSymbolizer cannot be parsed. Unsupported WellKnownName.")}return Number.isFinite(h)&&_.getImage()&&_.getImage().setOpacity(h),_}getOlIconSymbolizerFromIconSymbolizer(e,t){for(const l of Object.keys(e))S(e[l])&&(e[l]=g.evaluateFunction(e[l],t));const i={src:ne(e.image)?e.image.source:e.image,crossOrigin:"anonymous",opacity:e.opacity,width:e.size,rotation:typeof e.rotate=="number"?e.rotate*Math.PI/180:void 0,displacement:e.offset,size:ne(e.image)?e.image.size:void 0,offset:ne(e.image)?e.image.position:void 0},r="\\{\\{",s="\\}\\}",a=new RegExp(r+".*?"+s,"g");return(typeof e.image=="string"?e.image.match(a):null)?h=>{let f=g.resolveAttributeTemplate(h,e.image,"");f||(f=e.image+"");let u;return this.olIconStyleCache[f]?(u=this.olIconStyleCache[f],i.rotation!==void 0&&u.setRotation(i.rotation),i.opacity!==void 0&&u.setOpacity(i.opacity)):(u=new this.OlStyleIconConstructor({...i,src:f}),this.olIconStyleCache[f]=u),new this.OlStyleConstructor({image:u})}:new this.OlStyleConstructor({image:new this.OlStyleIconConstructor({...i})})}getOlLineSymbolizerFromLineSymbolizer(e,t){for(const a of Object.keys(e))S(e[a])&&(e[a]=g.evaluateFunction(e[a],t));const i=e.color,r=e.opacity,s=i&&r!==null&&r!==void 0?g.getRgbaColor(i,r):i;return new this.OlStyleConstructor({stroke:new this.OlStyleStrokeConstructor({color:s,width:e.width,lineCap:e.cap,lineJoin:e.join,lineDash:e.dasharray,lineDashOffset:e.dashOffset})})}getOlPolygonSymbolizerFromFillSymbolizer(e,t){for(const c of Object.keys(e))S(e[c])&&(e[c]=g.evaluateFunction(e[c],t));const i=e.color,r=e.fillOpacity,s=i&&Number.isFinite(r)?g.getRgbaColor(i,r):i;let a=i?new this.OlStyleFillConstructor({color:s}):void 0;const o=e.outlineColor,l=e.outlineOpacity,h=o&&Number.isFinite(l)?g.getRgbaColor(o,l):o,f=o||e.outlineWidth?new this.OlStyleStrokeConstructor({color:h,width:e.outlineWidth,lineDash:e.outlineDasharray}):void 0,u=new this.OlStyleConstructor({fill:a,stroke:f});if(e.graphicFill){const c=this.getOlPatternFromGraphicFill(e.graphicFill);a||(a=new this.OlStyleFillConstructor({})),c&&a.setColor(c),u.setFill(a)}return u}getOlPatternFromGraphicFill(e){let t;if(wt(e)){t=this.getOlIconSymbolizerFromIconSymbolizer(e);const c=t==null?void 0:t.getImage();if(c==null||c.load(),(c==null?void 0:c.getImageState())!==k.LOADED)return null}else if(yt(e))t=this.getOlPointSymbolizerFromMarkSymbolizer(e);else return null;const i=t.clone(),r=i.getImage(),s=document.createElement("canvas"),a=s.getContext("2d"),l=r.getScale()||1;r.setScale(1);const h=r.getSize(),f=ji(a,{pixelRatio:l,size:h});f.setStyle(i);const u=h.map(c=>c/2);return f.drawGeometry(new Si(u)),a.createPattern(s,"repeat")}getOlTextSymbolizerFromTextSymbolizer(e,t){for(const _ of Object.keys(e))S(e[_])&&(e[_]=g.evaluateFunction(e[_],t));const i=e.color;let r=e.placement;r||(r="point"),r==="line-center"&&(r="line");const s=e.opacity,a=i&&Number.isFinite(s)?g.getRgbaColor(i,s):i,o=e.haloColor,l=e.haloWidth,h=o&&Number.isFinite(s)?g.getRgbaColor(o,s):o,f={font:g.getTextFont(e),fill:new this.OlStyleFillConstructor({color:a}),stroke:new this.OlStyleStrokeConstructor({color:h,width:l||0}),overflow:e.allowOverlap,offsetX:e.offset?e.offset[0]:0,offsetY:e.offset?e.offset[1]:0,rotation:typeof e.rotate=="number"?e.rotate*Math.PI/180:void 0,placement:r},u="\\{\\{",c="\\}\\}",d=new RegExp(u+".*?"+c,"g");let m;return W(e.label)||(m=e.label?e.label.match(d):null),m?p=>{const v=new this.OlStyleTextConstructor({text:g.resolveAttributeTemplate(p,e.label,""),...f});return new this.OlStyleConstructor({text:v})}:new this.OlStyleConstructor({text:new this.OlStyleTextConstructor({text:e.label,...f})})}}C(Ce,"title","OpenLayers Style Parser");var Xi=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="arrow" d="M 0,-10 L 5,-5 L 2.5,-5 L 2.5,10 L -2.5,10 L -2.5,-5 L -5,-5 L 0,-10 Z"  style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,Yi=Object.freeze({__proto__:null,default:Xi}),Vi=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="arrowhead" d="M -10 -10 L 0 0 L -10 10"  style="fill: none; stroke: #000000; stroke-width: 1;" />\r
</svg>`,Hi=Object.freeze({__proto__:null,default:Vi}),Ui=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="asterisk_fill" d="M -1.5,-10 L 1.5,-10L 1.5,-3.939 L 6.011,-8.132 L 8.132,-6.011 L 3.939,-1.5 L 10,-1.5 L 10,1.5 L 3.939,1.5 L 8.132,6.011 L 6.011,8.132 L 1.5,3.939 L 1.5,10 L -1.5,10 L -1.5,3.939 L -6.011,8.132 L -8.132,6.011 L -3.939,1.5 L -10,1.5 L -10,-1.5 L -3.939,-1.5 L -8.132,-6.011 L -6.011,-8.132 L -1.5,-3.939 L -1.5,-10 Z"  style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,Ji=Object.freeze({__proto__:null,default:Ui}),Ki=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <circle id="circle" cx="0" cy="0" r="10" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,Zi=Object.freeze({__proto__:null,default:Ki}),Qi=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="cross" d="M -10 0 L 10 0 M 0 -10 L 0 10"  style="fill: none; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,en=Object.freeze({__proto__:null,default:Qi}),tn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="cross2" d="M -10 -10 L 10 10 M 10 -10 L -10 10"  style="fill: none; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,nn=Object.freeze({__proto__:null,default:tn}),rn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="cross_fill" d="M -10,-2 L -10,-2 L -10,2 L -2,2 L -2,10 L 2,10 L 2,2 L 10,2 L 10,-2 L 2,-2 L 2,-10 L -2,-10 L -2,-2 L -10,-2 Z"  style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,sn=Object.freeze({__proto__:null,default:rn}),an=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="decagon" points="5.878,8.09 9.511,3.09 9.511,-3.09 5.878,-8.09 0,-10 -5.878,-8.09 -9.511,-3.09 -9.511,3.09 -5.878,8.09 0,10 5.878,8.09" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,on=Object.freeze({__proto__:null,default:an}),ln=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="diagonal_half_square" points="-10,-10 10,10 -10,10 -10,-10" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,hn=Object.freeze({__proto__:null,default:ln}),cn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="diamond" points="-10,0 0,10 10,0 0,-10 -10,0" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,un=Object.freeze({__proto__:null,default:cn}),fn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="equilateral_triangle" points="-8.66,5 8.66,5 0,-10 -8.66,5" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,gn=Object.freeze({__proto__:null,default:fn}),dn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="filled_arrowhead" d="M 0,0 L -10,10 L -10,-10 L 0,0 Z"  style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,_n=Object.freeze({__proto__:null,default:dn}),mn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="half_arc" d="M -10 0 A -10 -10 0 0 1 10 0"  style="fill: none; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,pn=Object.freeze({__proto__:null,default:mn}),vn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="half_square" points="-10,-10 0,-10 0,10 -10,10 -10,-10" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,wn=Object.freeze({__proto__:null,default:vn}),yn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="heart" d="M -9.5 -2 A 1 1 0 0 1 0 -7.5 A 1 1 0 0 1 9.5 -2 L 0 10 Z"  style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>`,Sn=Object.freeze({__proto__:null,default:yn}),xn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="hexagon" points="-8.66,-5 -8.66,5 0,10 8.66,5 8.66,-5 0,-10 -8.66,-5" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,kn=Object.freeze({__proto__:null,default:xn}),On=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="left_half_triangle" points="0,10 10,10 0,-10 0,10" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,Cn=Object.freeze({__proto__:null,default:On}),bn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="line" d="M 0 -10 L 0 10"  style="fill: none; stroke: #000000; stroke-width: 1;" />\r
</svg>`,Fn=Object.freeze({__proto__:null,default:bn}),In=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="octagon" points="-4.142,10 4.142,10 10,4.142 10,-4.142 4.142,-10 -4.142,-10 -10,-4.142 -10,4.142 -4.142,10" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,Ln=Object.freeze({__proto__:null,default:In}),Mn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="parallelogram_left" points="10,5 5,-5 -10,-5 -5,5 10,5" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,Pn=Object.freeze({__proto__:null,default:Mn}),Tn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="parallelogram_right" points="5,5 10,-5 -5,-5 -10,5 5,5" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,En=Object.freeze({__proto__:null,default:Tn}),An=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="pentagon" points="-9.511,-3.09 -5.878,8.09 5.878,8.09 9.511,-3.09 0,-10 -9.511,-3.09" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,Rn=Object.freeze({__proto__:null,default:An}),Dn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="quarter_arc" d="M 0 -10 A 10 10 0 0 0 -10 0"  style="fill: none; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,zn=Object.freeze({__proto__:null,default:Dn}),Wn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="quarter_circle" d="M 0 -10 A 10 10 0 0 0 -10 0 L 0 0 Z"  style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,qn=Object.freeze({__proto__:null,default:Wn}),Gn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="quarter_square" points="-10,-10 0,-10 0,0 -10,0 -10,-10" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,Nn=Object.freeze({__proto__:null,default:Gn}),$n=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="right_half_triangle" points="-10,10 0,10 0,-10 -10,10" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,Bn=Object.freeze({__proto__:null,default:$n}),jn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <rect id="rounded_square" x="-10" y="-10" width="20" height="20" rx="2.5" ry="2.5" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,Xn=Object.freeze({__proto__:null,default:jn}),Yn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="semi_circle" d="M -10 0 A -10 -10 0 0 1 10 0 L 0 0 Z"  style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,Vn=Object.freeze({__proto__:null,default:Yn}),Hn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="shield" points="10,5 10,-10 -10,-10 -10,5 0,10 10,5" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,Un=Object.freeze({__proto__:null,default:Hn}),Jn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="square" points="-10,-10 10,-10 10,10 -10,10" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,Kn=Object.freeze({__proto__:null,default:Jn}),Zn=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="square_with_corners" points="-6.072,10 6.072,10 10,6.072 10,-6.072 6.072,-10 -6.072,-10 -10,-6.072 -10,6.072 -6.072,10" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,Qn=Object.freeze({__proto__:null,default:Zn}),er=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="star" d="M -2.24514,-3.09017 -9.51057,-3.09017 -3.63271,1.18034 -5.87785,8.09017 0,3.81966 5.87785,8.09017 3.63271,1.18034 9.51057,-3.09017 2.24514,-3.09017 0,-10 -2.24514,-3.09017 Z"  style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,tr=Object.freeze({__proto__:null,default:er}),ir=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="star_diamond" d="M -2.70091,-2.70091 -10,0 -2.70091,2.70091 0,10 2.70091,2.70091 10,0 2.70091,-2.70091 0,-10 Z"  style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,nr=Object.freeze({__proto__:null,default:ir}),rr=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="third_arc" d="M 0 -10 A 10 10 0 0 0 -5 8.66"  style="fill: none; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,sr=Object.freeze({__proto__:null,default:rr}),ar=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <path id="third_circle" d="M 0 -10 A 10 10 0 0 0 -5 8.66 L 0 0 Z"  style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,or=Object.freeze({__proto__:null,default:ar}),lr=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="trapezoid" points="5,-5 10,5 -10,5 -5,-5 5,-5" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,hr=Object.freeze({__proto__:null,default:lr}),cr=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-12 -12 24 24" width="40" height="40">\r
  <polygon id="triangle" points="-10,10 10,10 0,-10 -10,10" style="fill: #00ff00; stroke: #000000; stroke-width: 1;" />\r
</svg>\r
`,ur=Object.freeze({__proto__:null,default:cr});return b.OlStyleParser=Ce,b.default=Ce,b.getSvg=_t,Object.defineProperty(b,"__esModule",{value:!0}),b}({});
//# sourceMappingURL=olStyleParser.iife.js.map
