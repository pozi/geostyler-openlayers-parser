var GeoStylerOpenlayersParser=function($){"use strict";var pr=Object.defineProperty;var yr=($,q,H)=>q in $?pr($,q,{enumerable:!0,configurable:!0,writable:!0,value:H}):$[q]=H;var U=($,q,H)=>(yr($,typeof q!="symbol"?q+"":q,H),H);function q(o){return!/^(-?\d|--)/.test(o)}function H(o){const t=[];let e="",i="",s=7;for(let a,c=0;a=o.charAt(c);c++)if(/[a-zA-Z\d\xa0-\uffff_-]/.test(a)&&s===7)e+=a;else if(a==="\\"&&s===7)s=6;else if(a===" "&&s===7){if(e!==""){if(!q(e))return null;t.push(e),e=""}}else if(s===6)/[0-9a-f]/i.test(a)?(i+=a,s=8):(e+=a,s=7);else{if(s!==8)return null;/[0-9a-f]/i.test(a)&&i.length<6?i+=a:(e+=String.fromCodePoint(parseInt(i,16)),e+=a,i="",s=7)}if(e!==""){if(!q(e))return null;t.push(e)}return t.join(" ")}function ci(o,t){let e=t,i="";const s={"font-family":[]};for(let a,c=0;a=o.charAt(c);c+=1)if(e!==4||a!=='"'&&a!=="'")if(e===3&&a===",")e=4,i="";else if(e===4&&a===","){const l=H(i);l&&s["font-family"].push(l),i=""}else if(e===5&&a===" ")/^(?:\+|-)?(?:[0-9]*\.)?[0-9]+(?:deg|grad|rad|turn)$/.test(i)?(s["font-style"]+=" "+i,i=""):c-=1,e=1;else if(e!==1||a!==" "&&a!=="/")e===2&&a===" "?(/^(?:\+|-)?([0-9]*\.)?[0-9]+(?:em|ex|ch|rem|vh|vw|vmin|vmax|px|mm|cm|in|pt|pc|%)?$/.test(i)&&(s["line-height"]=i),e=4,i=""):i+=a;else{if(/^(?:(?:xx|x)-large|(?:xx|s)-small|small|large|medium)$/.test(i)||/^(?:larg|small)er$/.test(i)||/^(?:\+|-)?(?:[0-9]*\.)?[0-9]+(?:em|ex|ch|rem|vh|vw|vmin|vmax|px|mm|cm|in|pt|pc|%)$/.test(i))e=a==="/"?2:4,s["font-size"]=i;else if(/^italic$/.test(i))s["font-style"]=i;else if(/^oblique$/.test(i))s["font-style"]=i,e=5;else if(/^small-caps$/.test(i))s["font-variant"]=i;else if(/^(?:bold(?:er)?|lighter|normal)$/.test(i))s["font-weight"]=i;else if(/^[+-]?(?:[0-9]*\.)?[0-9]+(?:e[+-]?(?:0|[1-9][0-9]*))?$/.test(i)){const l=parseFloat(i);l>=1&&l<=1e3&&(s["font-weight"]=i)}else/^(?:(?:ultra|extra|semi)-)?(?:condensed|expanded)$/.test(i)&&(s["font-stretch"]=i);i=""}else{let l=c+1;do if(l=o.indexOf(a,l)+1,!l)return null;while(o.charAt(l-2)==="\\");s["font-family"].push(o.slice(c+1,l-1).replace(/\\('|")/g,"$1")),c=l-1,e=3,i=""}if(e===3&&!/^\s*$/.test(i))return null;if(e===4){const a=H(i);a&&s["font-family"].push(a)}return s}function ui(o){const t=ci(o,1);return t!==null&&t["font-size"]&&t["font-family"].length?t:null}function fi(o){return o!=null&&typeof o.valueOf()=="string"}const gi=o=>(o==null?void 0:o.kind)==="Icon",di=o=>(o==null?void 0:o.kind)==="Mark"&&fi(o==null?void 0:o.wellKnownName),bt=o=>["abs","acos","add","asin","atan","atan2","ceil","cos","div","exp","floor","interpolate","log","max","min","modulo","mul","pi","pow","random","rint","round","sin","sqrt","strIndexOf","strLastIndexOf","strLength","sub","tan","toDegrees","toNumber","toRadians"].includes(o==null?void 0:o.name),lt=o=>["numberFormat","strAbbreviate","strCapitalize","strConcat","strDefaultIfBlank","strReplace","strStripAccents","strSubstring","strSubstringStart","strToLowerCase","strToString","strToUpperCase","strTrim"].includes(o==null?void 0:o.name),mt=o=>["all","any","between","double2bool","equalTo","greaterThan","greaterThanOrEqualTo","in","lessThan","lessThanOrEqualTo","not","notEqualTo","parseBoolean","strEndsWith","strEqualsIgnoreCase","strMatches","strStartsWith"].includes(o==null?void 0:o.name),ce=o=>["case","property","step"].includes(o==null?void 0:o.name),B=o=>mt(o)||bt(o)||lt(o)||ce(o),At=o=>typeof(o==null?void 0:o.source)=="string"||B(o==null?void 0:o.source)&&Array.isArray(o.position)&&Array.isArray(o.size);var O={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class mi{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}var ue=mi,pi={PROPERTYCHANGE:"propertychange"};class yi{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}var _i=yi;function fe(o,t){const e=o.length;if(e!==t.length)return!1;for(let i=0;i<e;i++)if(o[i]!==t[i])return!1;return!0}function ge(){}function wi(o){let t,e,i;return function(){const s=Array.prototype.slice.call(arguments);return(!e||this!==i||!fe(s,e))&&(i=this,e=s,t=o.apply(this,arguments)),t}}function de(o){for(const t in o)delete o[t]}function xi(o){let t;for(t in o)return!1;return!t}class Si extends _i{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),s=i[t]||(i[t]=[]);s.includes(e)||s.push(e)}dispatchEvent(t){const e=typeof t=="string",i=e?t:t.type,s=this.listeners_&&this.listeners_[i];if(!s)return;const a=e?new ue(t):t;a.target||(a.target=this.eventTarget_||this);const c=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in c||(c[i]=0,l[i]=0),++c[i];let f;for(let d=0,p=s.length;d<p;++d)if("handleEvent"in s[d]?f=s[d].handleEvent(a):f=s[d].call(this,a),f===!1||a.propagationStopped){f=!1;break}if(--c[i]===0){let d=l[i];for(delete l[i];d--;)this.removeEventListener(i,ge);delete c[i]}return f}disposeInternal(){this.listeners_&&de(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const s=i.indexOf(e);s!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[s]=ge,++this.pendingRemovals_[t]):(i.splice(s,1),i.length===0&&delete this.listeners_[t]))}}var me=Si,K={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function pt(o,t,e,i,s){if(s){const c=e;e=function(){o.removeEventListener(t,e),c.apply(i??this,arguments)}}else i&&i!==o&&(e=e.bind(i));const a={target:o,type:t,listener:e};return o.addEventListener(t,e),a}function pe(o,t,e,i){return pt(o,t,e,i,!0)}function Lt(o){o&&o.target&&(o.target.removeEventListener(o.type,o.listener),de(o))}class yt extends me{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(K.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,s=new Array(i);for(let a=0;a<i;++a)s[a]=pt(this,t[a],e);return s}return pt(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const s=t.length;i=new Array(s);for(let a=0;a<s;++a)i[a]=pe(this,t[a],e)}else i=pe(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)Ci(i);else if(Array.isArray(t))for(let s=0,a=t.length;s<a;++s)this.removeEventListener(t[s],e);else this.removeEventListener(t,e)}}yt.prototype.on,yt.prototype.once,yt.prototype.un;function Ci(o){if(Array.isArray(o))for(let t=0,e=o.length;t<e;++t)Lt(o[t]);else Lt(o)}var Fi=yt;function A(){throw new Error("Unimplemented abstract method.")}let Ii=0;function ye(o){return o.ol_uid||(o.ol_uid=String(++Ii))}class _e extends ue{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}class Ei extends Fi{constructor(t){super(),this.on,this.once,this.un,ye(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new _e(i,t,e)),i=pi.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new _e(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const s=this.values_||(this.values_={});if(i)s[t]=e;else{const a=s[t];s[t]=e,a!==e&&this.notify(t,a)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],xi(this.values_)&&(this.values_=null),e||this.notify(t,i)}}}var Tt=Ei;function _t(o,t){if(!o)throw new Error(t)}const Oi=new Array(6);function Rt(){return[1,0,0,1,0,0]}function ki(o,t){const e=o[0],i=o[1],s=o[2],a=o[3],c=o[4],l=o[5],f=t[0],d=t[1],p=t[2],_=t[3],y=t[4],x=t[5];return o[0]=e*f+s*d,o[1]=i*f+a*d,o[2]=e*p+s*_,o[3]=i*p+a*_,o[4]=e*y+s*x+c,o[5]=i*y+a*x+l,o}function vi(o,t,e,i,s,a,c){return o[0]=t,o[1]=e,o[2]=i,o[3]=s,o[4]=a,o[5]=c,o}function bi(o,t,e){return ki(o,vi(Oi,t,0,0,e,0,0))}function we(o,t,e,i,s,a,c,l){const f=Math.sin(a),d=Math.cos(a);return o[0]=i*d,o[1]=s*f,o[2]=-i*f,o[3]=s*d,o[4]=c*i*d-l*i*f+t,o[5]=c*s*f+l*s*d+e,o}function Ai(o,t,e){return o[0]<=t&&t<=o[2]&&o[1]<=e&&e<=o[3]}function Li(){return[1/0,1/0,-1/0,-1/0]}function xe(o,t,e,i,s){return s?(s[0]=o,s[1]=t,s[2]=e,s[3]=i,s):[o,t,e,i]}function Se(o){return xe(1/0,1/0,-1/0,-1/0,o)}function Ti(o,t){const e=o[0],i=o[1];return xe(e,i,e,i,t)}function Ri(o,t,e,i,s){const a=Se(s);return Mi(a,o,t,e,i)}function Mi(o,t,e,i,s){for(;e<i;e+=s)Bi(o,t[e],t[e+1]);return o}function Bi(o,t,e){o[0]=Math.min(o[0],t),o[1]=Math.min(o[1],e),o[2]=Math.max(o[2],t),o[3]=Math.max(o[3],e)}function Di(o){return[(o[0]+o[2])/2,(o[1]+o[3])/2]}function Ce(o){return o[3]-o[1]}function ht(o,t){return o[0]<=t[2]&&o[2]>=t[0]&&o[1]<=t[3]&&o[3]>=t[1]}function Pi(o,t){return t?(t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t):o}const Fe={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Ni{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Fe[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}}var Ie=Ni;const ct=6378137,tt=Math.PI*ct,Ui=[-tt,-tt,tt,tt],Wi=[-180,-85,180,85],wt=ct*Math.log(Math.tan(Math.PI/2));class et extends Ie{constructor(t){super({code:t,units:"m",extent:Ui,global:!0,worldExtent:Wi,getPointResolution:function(e,i){return e/Math.cosh(i[1]/ct)}})}}const Ee=[new et("EPSG:3857"),new et("EPSG:102100"),new et("EPSG:102113"),new et("EPSG:900913"),new et("http://www.opengis.net/def/crs/EPSG/0/3857"),new et("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Gi(o,t,e,i){const s=o.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=o.slice():t=new Array(s));for(let a=0;a<s;a+=i){t[a]=tt*o[a]/180;let c=ct*Math.log(Math.tan(Math.PI*(+o[a+1]+90)/360));c>wt?c=wt:c<-wt&&(c=-wt),t[a+1]=c}return t}function zi(o,t,e,i){const s=o.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=o.slice():t=new Array(s));for(let a=0;a<s;a+=i)t[a]=180*o[a]/tt,t[a+1]=360*Math.atan(Math.exp(o[a+1]/ct))/Math.PI-90;return t}const $i=6378137,Oe=[-180,-90,180,90],qi=Math.PI*$i/180;class Z extends Ie{constructor(t,e){super({code:t,units:"degrees",extent:Oe,axisOrientation:e,global:!0,metersPerUnit:qi,worldExtent:Oe})}}const ke=[new Z("CRS:84"),new Z("EPSG:4326","neu"),new Z("urn:ogc:def:crs:OGC:1.3:CRS84"),new Z("urn:ogc:def:crs:OGC:2:84"),new Z("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Z("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Z("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Mt={};function Xi(o){return Mt[o]||Mt[o.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Yi(o,t){Mt[o]=t}let it={};function xt(o,t,e){const i=o.getCode(),s=t.getCode();i in it||(it[i]={}),it[i][s]=e}function Hi(o,t){let e;return o in it&&t in it[o]&&(e=it[o][t]),e}function St(o,t,e){return Math.min(Math.max(o,t),e)}function Vi(o,t,e,i){const s=e-o,a=i-t;return s*s+a*a}function ji(o,t){const e=Math.pow(10,t);return Math.round(o*e)/e}function ve(o,t){if(t!==void 0){for(let e=0,i=o.length;e<i;++e)t[e]=o[e];t=t}else t=o.slice();return t}function Ji(o,t){if(t!==void 0&&o!==t){for(let e=0,i=o.length;e<i;++e)t[e]=o[e];o=t}return o}function Ki(o){Yi(o.getCode(),o),xt(o,o,ve)}function Zi(o){o.forEach(Ki)}function Bt(o){return typeof o=="string"?Xi(o):o||null}function be(o){Zi(o),o.forEach(function(t){o.forEach(function(e){t!==e&&xt(t,e,ve)})})}function Qi(o,t,e,i){o.forEach(function(s){t.forEach(function(a){xt(s,a,e),xt(a,s,i)})})}function tn(o,t){const e=o.getCode(),i=t.getCode();let s=Hi(e,i);return s||(s=Ji),s}function Ae(o,t){const e=Bt(o),i=Bt(t);return tn(e,i)}function en(){be(Ee),be(ke),Qi(ke,Ee,Gi,zi)}en();function ut(o,t,e,i,s,a,c){a=a||[],c=c||2;let l=0;for(let f=t;f<e;f+=i){const d=o[f],p=o[f+1];a[l++]=s[0]*d+s[2]*p+s[4],a[l++]=s[1]*d+s[3]*p+s[5];for(let _=2;_<c;_++)a[l++]=o[f+_]}return a&&a.length!=l&&(a.length=l),a}function nn(o,t,e,i,s,a,c){c=c||[];const l=Math.cos(s),f=Math.sin(s),d=a[0],p=a[1];let _=0;for(let y=t;y<e;y+=i){const x=o[y]-d,C=o[y+1]-p;c[_++]=d+x*l-C*f,c[_++]=p+x*f+C*l;for(let F=y+2;F<y+i;++F)c[_++]=o[F]}return c&&c.length!=_&&(c.length=_),c}function rn(o,t,e,i,s,a,c,l){l=l||[];const f=c[0],d=c[1];let p=0;for(let _=t;_<e;_+=i){const y=o[_]-f,x=o[_+1]-d;l[p++]=f+s*y,l[p++]=d+a*x;for(let C=_+2;C<_+i;++C)l[p++]=o[C]}return l&&l.length!=p&&(l.length=p),l}function sn(o,t,e,i,s,a,c){c=c||[];let l=0;for(let f=t;f<e;f+=i){c[l++]=o[f]+s,c[l++]=o[f+1]+a;for(let d=f+2;d<f+i;++d)c[l++]=o[d]}return c&&c.length!=l&&(c.length=l),c}const Le=Rt();class on extends Tt{constructor(){super(),this.extent_=Li(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=wi((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const s=this.clone();return s.applyTransform(i),s.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return A()}closestPointXY(t,e,i,s){return A()}containsXY(t,e){const i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return A()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Se(e),this.extentRevision_=this.getRevision()}return Pi(this.extent_,t)}rotate(t,e){A()}scale(t,e,i){A()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return A()}getType(){return A()}applyTransform(t){A()}intersectsExtent(t){return A()}translate(t,e){A()}transform(t,e){const i=Bt(t),s=i.getUnits()=="tile-pixels"?function(a,c,l){const f=i.getExtent(),d=i.getWorldExtent(),p=Ce(d)/Ce(f);return we(Le,d[0],d[3],p,-p,0,0,0),ut(a,0,a.length,l,Le,c),Ae(i,e)(a,c,l)}:Ae(i,e);return this.applyTransform(s),this}}var an=on;class ln extends an{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return Ri(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return A()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=Te(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){A()}setLayout(t,e,i){let s;if(t)s=Te(t);else{for(let a=0;a<i;++a){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}s=e.length,t=hn(s)}this.layout=t,this.stride=s}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const s=this.getStride();nn(i,0,i.length,s,t,e,i),this.changed()}}scale(t,e,i){e===void 0&&(e=t),i||(i=Di(this.getExtent()));const s=this.getFlatCoordinates();if(s){const a=this.getStride();rn(s,0,s.length,a,t,e,i,s),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const s=this.getStride();sn(i,0,i.length,s,t,e,i),this.changed()}}}function hn(o){let t;return o==2?t="XY":o==3?t="XYZ":o==4&&(t="XYZM"),t}function Te(o){let t;return o=="XY"?t=2:o=="XYZ"||o=="XYM"?t=3:o=="XYZM"&&(t=4),t}function cn(o,t,e){const i=o.getFlatCoordinates();if(!i)return null;const s=o.getStride();return ut(i,0,i.length,s,t,e)}var un=ln;function fn(o,t,e,i){for(let s=0,a=e.length;s<a;++s)o[t++]=e[s];return t}class Dt extends un{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new Dt(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,s){const a=this.flatCoordinates,c=Vi(t,e,a[0],a[1]);if(c<s){const l=this.stride;for(let f=0;f<l;++f)i[f]=a[f];return i.length=l,c}return s}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return Ti(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Ai(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=fn(this.flatCoordinates,0,t,this.stride),this.changed()}}var gn=Dt;function Ct(o,t){return Array.isArray(o)?o:(t===void 0?t=[o,o]:(t[0]=o,t[1]=o),t)}class Pt{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Ct(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Pt({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return A()}getImage(t){return A()}getHitDetectionImage(){return A()}getPixelRatio(t){return 1}getImageState(){return A()}getImageSize(){return A()}getOrigin(){return A()}getSize(){return A()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Ct(t)}listenImageChange(t){A()}load(){A()}unlistenImageChange(t){A()}ready(){return Promise.resolve()}}var Nt=Pt,Ft={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},P={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"]};P.whitepoint={2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}},P.max=P.whitepoint[2].D65,P.rgb=function(o,t){t=t||P.whitepoint[2].E;var e=o[0]/t[0],i=o[1]/t[1],s=o[2]/t[2],a,c,l;return a=e*3.240969941904521+i*-1.537383177570093+s*-.498610760293,c=e*-.96924363628087+i*1.87596750150772+s*.041555057407175,l=e*.055630079696993+i*-.20397695888897+s*1.056971514242878,a=a>.0031308?1.055*Math.pow(a,.4166666666666667)-.055:a=a*12.92,c=c>.0031308?1.055*Math.pow(c,.4166666666666667)-.055:c=c*12.92,l=l>.0031308?1.055*Math.pow(l,.4166666666666667)-.055:l=l*12.92,a=Math.min(Math.max(0,a),1),c=Math.min(Math.max(0,c),1),l=Math.min(Math.max(0,l),1),[a*255,c*255,l*255]},Ft.xyz=function(o,t){var e=o[0]/255,i=o[1]/255,s=o[2]/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,s=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92;var a=e*.41239079926595+i*.35758433938387+s*.18048078840183,c=e*.21263900587151+i*.71516867876775+s*.072192315360733,l=e*.019330818715591+i*.11919477979462+s*.95053215224966;return t=t||P.whitepoint[2].E,[a*t[0],c*t[1],l*t[2]]};var Re={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(o,t,e){var i,s,a,c,l,f,d,p,_,y,x,C,F;if(a=o[0],c=o[1],l=o[2],a===0)return[0,0,0];var k=.0011070564598794539;return t=t||"D65",e=e||2,_=P.whitepoint[e][t][0],y=P.whitepoint[e][t][1],x=P.whitepoint[e][t][2],C=4*_/(_+15*y+3*x),F=9*y/(_+15*y+3*x),i=c/(13*a)+C||0,s=l/(13*a)+F||0,d=a>8?y*Math.pow((a+16)/116,3):y*a*k,f=d*9*i/(4*s)||0,p=d*(12-3*i-20*s)/(4*s)||0,[f,d,p]}};P.luv=function(o,t,e){var i,s,a,c,l,f,d,p,_,y,x,C,F,k=.008856451679035631,E=903.2962962962961;t=t||"D65",e=e||2,_=P.whitepoint[e][t][0],y=P.whitepoint[e][t][1],x=P.whitepoint[e][t][2],C=4*_/(_+15*y+3*x),F=9*y/(_+15*y+3*x),f=o[0],d=o[1],p=o[2],i=4*f/(f+15*d+3*p)||0,s=9*d/(f+15*d+3*p)||0;var R=d/y;return a=R<=k?E*R:116*Math.pow(R,.3333333333333333)-16,c=13*a*(i-C),l=13*a*(s-F),[a,c,l]},Re.lchuv=function(o){var t=o[0],e=o[1],i=o[2],s=Math.sqrt(e*e+i*i),a=Math.atan2(i,e),c=a*360/2/Math.PI;return c<0&&(c+=360),[t,s,c]},P.lchuv=function(o){return Re.lchuv(P.luv(o))};var Me={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Be={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function dn(o){var p,_;var t,e=[],i=1,s;if(typeof o=="number")return{space:"rgb",values:[o>>>16,(o&65280)>>>8,o&255],alpha:1};if(typeof o=="number")return{space:"rgb",values:[o>>>16,(o&65280)>>>8,o&255],alpha:1};if(o=String(o).toLowerCase(),Me[o])e=Me[o].slice(),s="rgb";else if(o==="transparent")i=0,s="rgb",e=[0,0,0];else if(o[0]==="#"){var a=o.slice(1),c=a.length,l=c<=4;i=1,l?(e=[parseInt(a[0]+a[0],16),parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16)],c===4&&(i=parseInt(a[3]+a[3],16)/255)):(e=[parseInt(a[0]+a[1],16),parseInt(a[2]+a[3],16),parseInt(a[4]+a[5],16)],c===8&&(i=parseInt(a[6]+a[7],16)/255)),e[0]||(e[0]=0),e[1]||(e[1]=0),e[2]||(e[2]=0),s="rgb"}else if(t=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(o)){var f=t[1];s=f.replace(/a$/,"");var d=s==="cmyk"?4:s==="gray"?1:3;e=t[2].trim().split(/\s*[,\/]\s*|\s+/),s==="color"&&(s=e.shift()),e=e.map(function(y,x){if(y[y.length-1]==="%")return y=parseFloat(y)/100,x===3?y:s==="rgb"?y*255:s[0]==="h"||s[0]==="l"&&!x?y*100:s==="lab"?y*125:s==="lch"?x<2?y*150:y*360:s[0]==="o"&&!x?y:s==="oklab"?y*.4:s==="oklch"?x<2?y*.4:y*360:y;if(s[x]==="h"||x===2&&s[s.length-1]==="h"){if(Be[y]!==void 0)return Be[y];if(y.endsWith("deg"))return parseFloat(y);if(y.endsWith("turn"))return parseFloat(y)*360;if(y.endsWith("grad"))return parseFloat(y)*360/400;if(y.endsWith("rad"))return parseFloat(y)*180/Math.PI}return y==="none"?0:parseFloat(y)}),i=e.length>d?e.pop():1}else/[0-9](?:\s|\/|,)/.test(o)&&(e=o.match(/([0-9]+)/g).map(function(y){return parseFloat(y)}),s=((_=(p=o.match(/([a-z])/ig))==null?void 0:p.join(""))==null?void 0:_.toLowerCase())||"rgb");return{space:s,values:e,alpha:i}}var Ut={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(o){var t=o[0]/360,e=o[1]/100,i=o[2]/100,s,a,c,l,f,d=0;if(e===0)return f=i*255,[f,f,f];for(a=i<.5?i*(1+e):i+e-i*e,s=2*i-a,l=[0,0,0];d<3;)c=t+1/3*-(d-1),c<0?c++:c>1&&c--,f=6*c<1?s+(a-s)*6*c:2*c<1?a:3*c<2?s+(a-s)*(2/3-c)*6:s,l[d++]=f*255;return l}};Ft.hsl=function(o){var t=o[0]/255,e=o[1]/255,i=o[2]/255,s=Math.min(t,e,i),a=Math.max(t,e,i),c=a-s,l,f,d;return a===s?l=0:t===a?l=(e-i)/c:e===a?l=2+(i-t)/c:i===a&&(l=4+(t-e)/c),l=Math.min(l*60,360),l<0&&(l+=360),d=(s+a)/2,a===s?f=0:d<=.5?f=c/(a+s):f=c/(2-a-s),[l,f*100,d*100]};function mn(o){Array.isArray(o)&&o.raw&&(o=String.raw(...arguments)),o instanceof Number&&(o=+o);var t,e=dn(o);if(!e.space)return[];const i=e.space[0]==="h"?Ut.min:Ft.min,s=e.space[0]==="h"?Ut.max:Ft.max;return t=Array(3),t[0]=Math.min(Math.max(e.values[0],i[0]),s[0]),t[1]=Math.min(Math.max(e.values[1],i[1]),s[1]),t[2]=Math.min(Math.max(e.values[2],i[2]),s[2]),e.space[0]==="h"&&(t=Ut.rgb(t)),t.push(Math.min(Math.max(e.alpha,0),1)),t}const pn=[NaN,NaN,NaN,0];function yn(o){return typeof o=="string"?o:De(o)}const _n=1024,ft={};let Wt=0;function wn(o){if(o==="none")return pn;if(ft.hasOwnProperty(o))return ft[o];if(Wt>=_n){let e=0;for(const i in ft)e++&3||(delete ft[i],--Wt)}const t=mn(o);if(t.length!==4)throw new Error('failed to parse "'+o+'" as color');for(const e of t)if(isNaN(e))throw new Error('failed to parse "'+o+'" as color');return xn(t),ft[o]=t,++Wt,t}function Gt(o){return Array.isArray(o)?o:wn(o)}function xn(o){return o[0]=St(o[0]+.5|0,0,255),o[1]=St(o[1]+.5|0,0,255),o[2]=St(o[2]+.5|0,0,255),o[3]=St(o[3],0,1),o}function De(o){let t=o[0];t!=(t|0)&&(t=t+.5|0);let e=o[1];e!=(e|0)&&(e=e+.5|0);let i=o[2];i!=(i|0)&&(i=i+.5|0);const s=o[3]===void 0?1:Math.round(o[3]*1e3)/1e3;return"rgba("+t+","+e+","+i+","+s+")"}const V=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"";V.includes("firefox"),V.includes("safari")&&!V.includes("chrom")&&(V.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(V)),V.includes("webkit")&&V.includes("edge"),V.includes("macintosh");const Sn=typeof devicePixelRatio<"u"?devicePixelRatio:1,Cn=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Fn=typeof Image<"u"&&Image.prototype.decode;(function(){let o=!1;try{const t=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return o})();function Q(o,t,e,i){let s;return e&&e.length?s=e.shift():Cn?s=new OffscreenCanvas(o||300,t||300):s=document.createElement("canvas"),o&&(s.width=o),t&&(s.height=t),s.getContext("2d",i)}let zt;function Pe(){return zt||(zt=Q(1,1)),zt}function In(o,t){return new Promise((e,i)=>{function s(){c(),e(o)}function a(){c(),i(new Error("Image load error"))}function c(){o.removeEventListener("load",s),o.removeEventListener("error",a)}o.addEventListener("load",s),o.addEventListener("error",a),t&&(o.src=t)})}function En(o,t){return t&&(o.src=t),o.src&&Fn?new Promise((e,i)=>o.decode().then(()=>e(o)).catch(s=>o.complete&&o.width?e(o):i(s))):In(o)}class On{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];!(t++&3)&&!i.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,i){const s=$t(t,e,i);return s in this.cache_?this.cache_[s]:null}getPattern(t,e,i){const s=$t(t,e,i);return s in this.patternCache_?this.patternCache_[s]:null}set(t,e,i,s,a){const c=$t(t,e,i),l=c in this.cache_;this.cache_[c]=s,a&&(s.getImageState()===O.IDLE&&s.load(),s.getImageState()===O.LOADING?s.ready().then(()=>{this.patternCache_[c]=Pe().createPattern(s.getImage(1),"repeat")}):this.patternCache_[c]=Pe().createPattern(s.getImage(1),"repeat")),l||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function $t(o,t,e){const i=e?Gt(e):"null";return t+":"+o+":"+i}const j=new On;let gt=null;class kn extends me{constructor(t,e,i,s,a){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=a,this.imageState_=s===void 0?O.IDLE:s,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===O.LOADED){gt||(gt=Q(1,1,void 0,{willReadFrequently:!0})),gt.drawImage(this.image_,0,0);try{gt.getImageData(0,0,1,1),this.tainted_=!1}catch{gt=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(K.CHANGE)}handleImageError_(){this.imageState_=O.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=O.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=Q(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===O.IDLE){this.image_||this.initializeImage_(),this.imageState_=O.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&En(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==O.LOADED)return;const e=this.image_,i=Q(Math.ceil(e.width*t),Math.ceil(e.height*t)),s=i.canvas;i.scale(t,t),i.drawImage(e,0,0),i.globalCompositeOperation="multiply",i.fillStyle=yn(this.color_),i.fillRect(0,0,s.width/t,s.height/t),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0),this.canvas_[t]=s}ready(){return this.ready_||(this.ready_=new Promise(t=>{if(this.imageState_===O.LOADED||this.imageState_===O.ERROR)t();else{const e=()=>{(this.imageState_===O.LOADED||this.imageState_===O.ERROR)&&(this.removeEventListener(K.CHANGE,e),t())};this.addEventListener(K.CHANGE,e)}})),this.ready_}}function qt(o,t,e,i,s,a){let c=t===void 0?void 0:j.get(t,e,s);return c||(c=new kn(o,o&&"src"in o?o.src||void 0:t,e,i,s),j.set(t,e,s,c,a)),a&&c&&!j.getPattern(t,e,s)&&j.set(t,e,s,c,a),c}function nt(o){return o?Array.isArray(o)?De(o):typeof o=="object"&&"src"in o?vn(o):o:null}function vn(o){if(!o.offset||!o.size)return j.getPattern(o.src,"anonymous",o.color);const t=o.src+":"+o.offset,e=j.getPattern(t,void 0,o.color);if(e)return e;const i=j.get(o.src,"anonymous",null);if(i.getImageState()!==O.LOADED)return null;const s=Q(o.size[0],o.size[1]);return s.drawImage(i.getImage(1),o.offset[0],o.offset[1],o.size[0],o.size[1],0,0,o.size[0],o.size[1]),qt(s.canvas,t,void 0,O.LOADED,o.color,!0),j.getPattern(t,void 0,o.color)}const bn="10px sans-serif",It="#000",Et="round",Ne=[],Ue=0,Ot="round",Xt=10,Yt="#000",We="center",An="middle",Ht=1;new Tt;class Vt extends Nt{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?O.LOADING:O.LOADED,this.imageState_===O.LOADING&&this.ready().then(()=>this.imageState_=O.LOADED),this.render()}clone(){const t=this.getScale(),e=new Vt({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const i=this.renderOptions_,s=Q(i.size*t,i.size*t);this.draw_(i,s,t),e=s.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let s=this.radius,a=this.radius2_===void 0?s:this.radius2_;if(s<a){const st=s;s=a,a=st}const c=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/c,f=a*Math.sin(l),d=Math.sqrt(a*a-f*f),p=s-d,_=Math.sqrt(f*f+p*p),y=_/f;if(t==="miter"&&y<=i)return y*e;const x=e/2/y,C=e/2*(p/_),k=Math.sqrt((s+x)*(s+x)+C*C)-s;if(this.radius2_===void 0||t==="bevel")return k*2;const E=s*Math.sin(l),R=Math.sqrt(s*s-E*E),M=a-R,W=Math.sqrt(E*E+M*M)/E;if(W<=i){const st=W*e/2-a-s;return 2*Math.max(k,st)}return k*2}createRenderOptions(){let t=Et,e=Ot,i=0,s=null,a=0,c,l=0;this.stroke_&&(c=nt(this.stroke_.getColor()??Yt),l=this.stroke_.getWidth()??Ht,s=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??Ot,t=this.stroke_.getLineCap()??Et,i=this.stroke_.getMiterLimit()??Xt);const f=this.calculateLineJoinSize_(e,l,i),d=Math.max(this.radius,this.radius2_||0),p=Math.ceil(2*d+f);return{strokeStyle:c,strokeWidth:l,size:p,lineCap:t,lineDash:s,lineDashOffset:a,lineJoin:e,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let s=this.fill_.getColor();s===null&&(s=It),e.fillStyle=nt(s),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),s=0;typeof i=="string"&&(i=Gt(i)),i===null?s=1:Array.isArray(i)&&(s=i.length===4?i[3]:1),s===0&&(e=Q(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const s=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(e*=2);const a=this.angle_-Math.PI/2,c=2*Math.PI/e;for(let l=0;l<e;l++){const f=a+l*c,d=l%2===0?i:s;t.lineTo(d*Math.cos(f),d*Math.sin(f))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=It,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}var Ge=Vt;class jt extends Ge{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new jt({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}}var Ln=jt;class Jt{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){const t=this.getColor();return new Jt({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){const e=qt(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===O.IDLE&&e.load(),e.getImageState()===O.LOADING&&(this.patternImage_=e)}this.color_=t}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}var ze=Jt;class Kt{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Kt({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}var Tn=Kt;class Zt{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=$e,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new Zt({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=$e,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function $e(o){return o.getGeometry()}var qe=Zt;const Rn="#333";class Qt{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=Ct(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new ze({color:Rn}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Qt({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Ct(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}var Mn=Qt;function Xe(o,t,e,i){return e!==void 0&&i!==void 0?[e/o,i/t]:e!==void 0?e/o:i!==void 0?i/t:1}class te extends Nt{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,i=t.rotation!==void 0?t.rotation:0,s=t.scale!==void 0?t.scale:1,a=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:i,scale:s,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:a,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const c=t.img!==void 0?t.img:null;let l=t.src;_t(!(l!==void 0&&c),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&c&&(l=c.src||ye(c)),_t(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),_t(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let f;if(t.src!==void 0?f=O.IDLE:c!==void 0&&("complete"in c?c.complete?f=c.src?O.LOADED:O.IDLE:f=O.LOADING:f=O.LOADED),this.color_=t.color!==void 0?Gt(t.color):null,this.iconImage_=qt(c,l,this.crossOrigin_,f,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,this.initialOptions_,t.width!==void 0||t.height!==void 0){let d,p;if(t.size)[d,p]=t.size;else{const _=this.getImage(1);if(_.width&&_.height)d=_.width,p=_.height;else if(_ instanceof HTMLImageElement){this.initialOptions_=t;const y=()=>{if(this.unlistenImageChange(y),!this.initialOptions_)return;const x=this.iconImage_.getSize();this.setScale(Xe(x[0],x[1],t.width,t.height))};this.listenImageChange(y);return}}d!==void 0&&this.setScale(Xe(d,p,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new te({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const s=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!s)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=s[0]),this.anchorYUnits_=="fraction"&&(t[1]*=s[1])}if(this.anchorOrigin_!="top-left"){if(!s)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+s[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+s[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=i[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==O.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==O.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(K.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(K.CHANGE,t)}ready(){return this.iconImage_.ready()}}var Ye=te;const He={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var ee={},kt={};kt.byteLength=Pn,kt.toByteArray=Un,kt.fromByteArray=zn;for(var X=[],G=[],Bn=typeof Uint8Array<"u"?Uint8Array:Array,ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rt=0,Dn=ie.length;rt<Dn;++rt)X[rt]=ie[rt],G[ie.charCodeAt(rt)]=rt;G["-".charCodeAt(0)]=62,G["_".charCodeAt(0)]=63;function Ve(o){var t=o.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=o.indexOf("=");e===-1&&(e=t);var i=e===t?0:4-e%4;return[e,i]}function Pn(o){var t=Ve(o),e=t[0],i=t[1];return(e+i)*3/4-i}function Nn(o,t,e){return(t+e)*3/4-e}function Un(o){var t,e=Ve(o),i=e[0],s=e[1],a=new Bn(Nn(o,i,s)),c=0,l=s>0?i-4:i,f;for(f=0;f<l;f+=4)t=G[o.charCodeAt(f)]<<18|G[o.charCodeAt(f+1)]<<12|G[o.charCodeAt(f+2)]<<6|G[o.charCodeAt(f+3)],a[c++]=t>>16&255,a[c++]=t>>8&255,a[c++]=t&255;return s===2&&(t=G[o.charCodeAt(f)]<<2|G[o.charCodeAt(f+1)]>>4,a[c++]=t&255),s===1&&(t=G[o.charCodeAt(f)]<<10|G[o.charCodeAt(f+1)]<<4|G[o.charCodeAt(f+2)]>>2,a[c++]=t>>8&255,a[c++]=t&255),a}function Wn(o){return X[o>>18&63]+X[o>>12&63]+X[o>>6&63]+X[o&63]}function Gn(o,t,e){for(var i,s=[],a=t;a<e;a+=3)i=(o[a]<<16&16711680)+(o[a+1]<<8&65280)+(o[a+2]&255),s.push(Wn(i));return s.join("")}function zn(o){for(var t,e=o.length,i=e%3,s=[],a=16383,c=0,l=e-i;c<l;c+=a)s.push(Gn(o,c,c+a>l?l:c+a));return i===1?(t=o[e-1],s.push(X[t>>2]+X[t<<4&63]+"==")):i===2&&(t=(o[e-2]<<8)+o[e-1],s.push(X[t>>10]+X[t>>4&63]+X[t<<2&63]+"=")),s.join("")}var ne={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ne.read=function(o,t,e,i,s){var a,c,l=s*8-i-1,f=(1<<l)-1,d=f>>1,p=-7,_=e?s-1:0,y=e?-1:1,x=o[t+_];for(_+=y,a=x&(1<<-p)-1,x>>=-p,p+=l;p>0;a=a*256+o[t+_],_+=y,p-=8);for(c=a&(1<<-p)-1,a>>=-p,p+=i;p>0;c=c*256+o[t+_],_+=y,p-=8);if(a===0)a=1-d;else{if(a===f)return c?NaN:(x?-1:1)*(1/0);c=c+Math.pow(2,i),a=a-d}return(x?-1:1)*c*Math.pow(2,a-i)},ne.write=function(o,t,e,i,s,a){var c,l,f,d=a*8-s-1,p=(1<<d)-1,_=p>>1,y=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,x=i?0:a-1,C=i?1:-1,F=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(l=isNaN(t)?1:0,c=p):(c=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-c))<1&&(c--,f*=2),c+_>=1?t+=y/f:t+=y*Math.pow(2,1-_),t*f>=2&&(c++,f/=2),c+_>=p?(l=0,c=p):c+_>=1?(l=(t*f-1)*Math.pow(2,s),c=c+_):(l=t*Math.pow(2,_-1)*Math.pow(2,s),c=0));s>=8;o[e+x]=l&255,x+=C,l/=256,s-=8);for(c=c<<s|l,d+=s;d>0;o[e+x]=c&255,x+=C,c/=256,d-=8);o[e+x-C]|=F*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(o){const t=kt,e=ne,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;o.Buffer=l,o.SlowBuffer=R,o.INSPECT_MAX_BYTES=50;const s=2147483647;o.kMaxLength=s,l.TYPED_ARRAY_SUPPORT=a(),!l.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const h=new Uint8Array(1),n={foo:function(){return 42}};return Object.setPrototypeOf(n,Uint8Array.prototype),Object.setPrototypeOf(h,n),h.foo()===42}catch{return!1}}Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}});function c(h){if(h>s)throw new RangeError('The value "'+h+'" is invalid for option "size"');const n=new Uint8Array(h);return Object.setPrototypeOf(n,l.prototype),n}function l(h,n,r){if(typeof h=="number"){if(typeof n=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return _(h)}return f(h,n,r)}l.poolSize=8192;function f(h,n,r){if(typeof h=="string")return y(h,n);if(ArrayBuffer.isView(h))return C(h);if(h==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h);if(Y(h,ArrayBuffer)||h&&Y(h.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Y(h,SharedArrayBuffer)||h&&Y(h.buffer,SharedArrayBuffer)))return F(h,n,r);if(typeof h=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const u=h.valueOf&&h.valueOf();if(u!=null&&u!==h)return l.from(u,n,r);const g=k(h);if(g)return g;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof h[Symbol.toPrimitive]=="function")return l.from(h[Symbol.toPrimitive]("string"),n,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h)}l.from=function(h,n,r){return f(h,n,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array);function d(h){if(typeof h!="number")throw new TypeError('"size" argument must be of type number');if(h<0)throw new RangeError('The value "'+h+'" is invalid for option "size"')}function p(h,n,r){return d(h),h<=0?c(h):n!==void 0?typeof r=="string"?c(h).fill(n,r):c(h).fill(n):c(h)}l.alloc=function(h,n,r){return p(h,n,r)};function _(h){return d(h),c(h<0?0:E(h)|0)}l.allocUnsafe=function(h){return _(h)},l.allocUnsafeSlow=function(h){return _(h)};function y(h,n){if((typeof n!="string"||n==="")&&(n="utf8"),!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);const r=M(h,n)|0;let u=c(r);const g=u.write(h,n);return g!==r&&(u=u.slice(0,g)),u}function x(h){const n=h.length<0?0:E(h.length)|0,r=c(n);for(let u=0;u<n;u+=1)r[u]=h[u]&255;return r}function C(h){if(Y(h,Uint8Array)){const n=new Uint8Array(h);return F(n.buffer,n.byteOffset,n.byteLength)}return x(h)}function F(h,n,r){if(n<0||h.byteLength<n)throw new RangeError('"offset" is outside of buffer bounds');if(h.byteLength<n+(r||0))throw new RangeError('"length" is outside of buffer bounds');let u;return n===void 0&&r===void 0?u=new Uint8Array(h):r===void 0?u=new Uint8Array(h,n):u=new Uint8Array(h,n,r),Object.setPrototypeOf(u,l.prototype),u}function k(h){if(l.isBuffer(h)){const n=E(h.length)|0,r=c(n);return r.length===0||h.copy(r,0,0,n),r}if(h.length!==void 0)return typeof h.length!="number"||he(h.length)?c(0):x(h);if(h.type==="Buffer"&&Array.isArray(h.data))return x(h.data)}function E(h){if(h>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return h|0}function R(h){return+h!=h&&(h=0),l.alloc(+h)}l.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==l.prototype},l.compare=function(n,r){if(Y(n,Uint8Array)&&(n=l.from(n,n.offset,n.byteLength)),Y(r,Uint8Array)&&(r=l.from(r,r.offset,r.byteLength)),!l.isBuffer(n)||!l.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===r)return 0;let u=n.length,g=r.length;for(let m=0,w=Math.min(u,g);m<w;++m)if(n[m]!==r[m]){u=n[m],g=r[m];break}return u<g?-1:g<u?1:0},l.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(n,r){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return l.alloc(0);let u;if(r===void 0)for(r=0,u=0;u<n.length;++u)r+=n[u].length;const g=l.allocUnsafe(r);let m=0;for(u=0;u<n.length;++u){let w=n[u];if(Y(w,Uint8Array))m+w.length>g.length?(l.isBuffer(w)||(w=l.from(w)),w.copy(g,m)):Uint8Array.prototype.set.call(g,w,m);else if(l.isBuffer(w))w.copy(g,m);else throw new TypeError('"list" argument must be an Array of Buffers');m+=w.length}return g};function M(h,n){if(l.isBuffer(h))return h.length;if(ArrayBuffer.isView(h)||Y(h,ArrayBuffer))return h.byteLength;if(typeof h!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof h);const r=h.length,u=arguments.length>2&&arguments[2]===!0;if(!u&&r===0)return 0;let g=!1;for(;;)switch(n){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return le(h).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return hi(h).length;default:if(g)return u?-1:le(h).length;n=(""+n).toLowerCase(),g=!0}}l.byteLength=M;function z(h,n,r){let u=!1;if((n===void 0||n<0)&&(n=0),n>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,n>>>=0,r<=n))return"";for(h||(h="utf8");;)switch(h){case"hex":return ar(this,n,r);case"utf8":case"utf-8":return ti(this,n,r);case"ascii":return sr(this,n,r);case"latin1":case"binary":return or(this,n,r);case"base64":return nr(this,n,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return lr(this,n,r);default:if(u)throw new TypeError("Unknown encoding: "+h);h=(h+"").toLowerCase(),u=!0}}l.prototype._isBuffer=!0;function W(h,n,r){const u=h[n];h[n]=h[r],h[r]=u}l.prototype.swap16=function(){const n=this.length;if(n%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<n;r+=2)W(this,r,r+1);return this},l.prototype.swap32=function(){const n=this.length;if(n%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<n;r+=4)W(this,r,r+3),W(this,r+1,r+2);return this},l.prototype.swap64=function(){const n=this.length;if(n%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<n;r+=8)W(this,r,r+7),W(this,r+1,r+6),W(this,r+2,r+5),W(this,r+3,r+4);return this},l.prototype.toString=function(){const n=this.length;return n===0?"":arguments.length===0?ti(this,0,n):z.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(n){if(!l.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?!0:l.compare(this,n)===0},l.prototype.inspect=function(){let n="";const r=o.INSPECT_MAX_BYTES;return n=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(n+=" ... "),"<Buffer "+n+">"},i&&(l.prototype[i]=l.prototype.inspect),l.prototype.compare=function(n,r,u,g,m){if(Y(n,Uint8Array)&&(n=l.from(n,n.offset,n.byteLength)),!l.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(r===void 0&&(r=0),u===void 0&&(u=n?n.length:0),g===void 0&&(g=0),m===void 0&&(m=this.length),r<0||u>n.length||g<0||m>this.length)throw new RangeError("out of range index");if(g>=m&&r>=u)return 0;if(g>=m)return-1;if(r>=u)return 1;if(r>>>=0,u>>>=0,g>>>=0,m>>>=0,this===n)return 0;let w=m-g,I=u-r;const L=Math.min(w,I),b=this.slice(g,m),T=n.slice(r,u);for(let v=0;v<L;++v)if(b[v]!==T[v]){w=b[v],I=T[v];break}return w<I?-1:I<w?1:0};function st(h,n,r,u,g){if(h.length===0)return-1;if(typeof r=="string"?(u=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,he(r)&&(r=g?0:h.length-1),r<0&&(r=h.length+r),r>=h.length){if(g)return-1;r=h.length-1}else if(r<0)if(g)r=0;else return-1;if(typeof n=="string"&&(n=l.from(n,u)),l.isBuffer(n))return n.length===0?-1:Qe(h,n,r,u,g);if(typeof n=="number")return n=n&255,typeof Uint8Array.prototype.indexOf=="function"?g?Uint8Array.prototype.indexOf.call(h,n,r):Uint8Array.prototype.lastIndexOf.call(h,n,r):Qe(h,[n],r,u,g);throw new TypeError("val must be string, number or Buffer")}function Qe(h,n,r,u,g){let m=1,w=h.length,I=n.length;if(u!==void 0&&(u=String(u).toLowerCase(),u==="ucs2"||u==="ucs-2"||u==="utf16le"||u==="utf-16le")){if(h.length<2||n.length<2)return-1;m=2,w/=2,I/=2,r/=2}function L(T,v){return m===1?T[v]:T.readUInt16BE(v*m)}let b;if(g){let T=-1;for(b=r;b<w;b++)if(L(h,b)===L(n,T===-1?0:b-T)){if(T===-1&&(T=b),b-T+1===I)return T*m}else T!==-1&&(b-=b-T),T=-1}else for(r+I>w&&(r=w-I),b=r;b>=0;b--){let T=!0;for(let v=0;v<I;v++)if(L(h,b+v)!==L(n,v)){T=!1;break}if(T)return b}return-1}l.prototype.includes=function(n,r,u){return this.indexOf(n,r,u)!==-1},l.prototype.indexOf=function(n,r,u){return st(this,n,r,u,!0)},l.prototype.lastIndexOf=function(n,r,u){return st(this,n,r,u,!1)};function Zn(h,n,r,u){r=Number(r)||0;const g=h.length-r;u?(u=Number(u),u>g&&(u=g)):u=g;const m=n.length;u>m/2&&(u=m/2);let w;for(w=0;w<u;++w){const I=parseInt(n.substr(w*2,2),16);if(he(I))return w;h[r+w]=I}return w}function Qn(h,n,r,u){return vt(le(n,h.length-r),h,r,u)}function tr(h,n,r,u){return vt(fr(n),h,r,u)}function er(h,n,r,u){return vt(hi(n),h,r,u)}function ir(h,n,r,u){return vt(gr(n,h.length-r),h,r,u)}l.prototype.write=function(n,r,u,g){if(r===void 0)g="utf8",u=this.length,r=0;else if(u===void 0&&typeof r=="string")g=r,u=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(u)?(u=u>>>0,g===void 0&&(g="utf8")):(g=u,u=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const m=this.length-r;if((u===void 0||u>m)&&(u=m),n.length>0&&(u<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");g||(g="utf8");let w=!1;for(;;)switch(g){case"hex":return Zn(this,n,r,u);case"utf8":case"utf-8":return Qn(this,n,r,u);case"ascii":case"latin1":case"binary":return tr(this,n,r,u);case"base64":return er(this,n,r,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ir(this,n,r,u);default:if(w)throw new TypeError("Unknown encoding: "+g);g=(""+g).toLowerCase(),w=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function nr(h,n,r){return n===0&&r===h.length?t.fromByteArray(h):t.fromByteArray(h.slice(n,r))}function ti(h,n,r){r=Math.min(h.length,r);const u=[];let g=n;for(;g<r;){const m=h[g];let w=null,I=m>239?4:m>223?3:m>191?2:1;if(g+I<=r){let L,b,T,v;switch(I){case 1:m<128&&(w=m);break;case 2:L=h[g+1],(L&192)===128&&(v=(m&31)<<6|L&63,v>127&&(w=v));break;case 3:L=h[g+1],b=h[g+2],(L&192)===128&&(b&192)===128&&(v=(m&15)<<12|(L&63)<<6|b&63,v>2047&&(v<55296||v>57343)&&(w=v));break;case 4:L=h[g+1],b=h[g+2],T=h[g+3],(L&192)===128&&(b&192)===128&&(T&192)===128&&(v=(m&15)<<18|(L&63)<<12|(b&63)<<6|T&63,v>65535&&v<1114112&&(w=v))}}w===null?(w=65533,I=1):w>65535&&(w-=65536,u.push(w>>>10&1023|55296),w=56320|w&1023),u.push(w),g+=I}return rr(u)}const ei=4096;function rr(h){const n=h.length;if(n<=ei)return String.fromCharCode.apply(String,h);let r="",u=0;for(;u<n;)r+=String.fromCharCode.apply(String,h.slice(u,u+=ei));return r}function sr(h,n,r){let u="";r=Math.min(h.length,r);for(let g=n;g<r;++g)u+=String.fromCharCode(h[g]&127);return u}function or(h,n,r){let u="";r=Math.min(h.length,r);for(let g=n;g<r;++g)u+=String.fromCharCode(h[g]);return u}function ar(h,n,r){const u=h.length;(!n||n<0)&&(n=0),(!r||r<0||r>u)&&(r=u);let g="";for(let m=n;m<r;++m)g+=dr[h[m]];return g}function lr(h,n,r){const u=h.slice(n,r);let g="";for(let m=0;m<u.length-1;m+=2)g+=String.fromCharCode(u[m]+u[m+1]*256);return g}l.prototype.slice=function(n,r){const u=this.length;n=~~n,r=r===void 0?u:~~r,n<0?(n+=u,n<0&&(n=0)):n>u&&(n=u),r<0?(r+=u,r<0&&(r=0)):r>u&&(r=u),r<n&&(r=n);const g=this.subarray(n,r);return Object.setPrototypeOf(g,l.prototype),g};function D(h,n,r){if(h%1!==0||h<0)throw new RangeError("offset is not uint");if(h+n>r)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUintLE=l.prototype.readUIntLE=function(n,r,u){n=n>>>0,r=r>>>0,u||D(n,r,this.length);let g=this[n],m=1,w=0;for(;++w<r&&(m*=256);)g+=this[n+w]*m;return g},l.prototype.readUintBE=l.prototype.readUIntBE=function(n,r,u){n=n>>>0,r=r>>>0,u||D(n,r,this.length);let g=this[n+--r],m=1;for(;r>0&&(m*=256);)g+=this[n+--r]*m;return g},l.prototype.readUint8=l.prototype.readUInt8=function(n,r){return n=n>>>0,r||D(n,1,this.length),this[n]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(n,r){return n=n>>>0,r||D(n,2,this.length),this[n]|this[n+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(n,r){return n=n>>>0,r||D(n,2,this.length),this[n]<<8|this[n+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(n,r){return n=n>>>0,r||D(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+this[n+3]*16777216},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(n,r){return n=n>>>0,r||D(n,4,this.length),this[n]*16777216+(this[n+1]<<16|this[n+2]<<8|this[n+3])},l.prototype.readBigUInt64LE=J(function(n){n=n>>>0,at(n,"offset");const r=this[n],u=this[n+7];(r===void 0||u===void 0)&&dt(n,this.length-8);const g=r+this[++n]*2**8+this[++n]*2**16+this[++n]*2**24,m=this[++n]+this[++n]*2**8+this[++n]*2**16+u*2**24;return BigInt(g)+(BigInt(m)<<BigInt(32))}),l.prototype.readBigUInt64BE=J(function(n){n=n>>>0,at(n,"offset");const r=this[n],u=this[n+7];(r===void 0||u===void 0)&&dt(n,this.length-8);const g=r*2**24+this[++n]*2**16+this[++n]*2**8+this[++n],m=this[++n]*2**24+this[++n]*2**16+this[++n]*2**8+u;return(BigInt(g)<<BigInt(32))+BigInt(m)}),l.prototype.readIntLE=function(n,r,u){n=n>>>0,r=r>>>0,u||D(n,r,this.length);let g=this[n],m=1,w=0;for(;++w<r&&(m*=256);)g+=this[n+w]*m;return m*=128,g>=m&&(g-=Math.pow(2,8*r)),g},l.prototype.readIntBE=function(n,r,u){n=n>>>0,r=r>>>0,u||D(n,r,this.length);let g=r,m=1,w=this[n+--g];for(;g>0&&(m*=256);)w+=this[n+--g]*m;return m*=128,w>=m&&(w-=Math.pow(2,8*r)),w},l.prototype.readInt8=function(n,r){return n=n>>>0,r||D(n,1,this.length),this[n]&128?(255-this[n]+1)*-1:this[n]},l.prototype.readInt16LE=function(n,r){n=n>>>0,r||D(n,2,this.length);const u=this[n]|this[n+1]<<8;return u&32768?u|4294901760:u},l.prototype.readInt16BE=function(n,r){n=n>>>0,r||D(n,2,this.length);const u=this[n+1]|this[n]<<8;return u&32768?u|4294901760:u},l.prototype.readInt32LE=function(n,r){return n=n>>>0,r||D(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},l.prototype.readInt32BE=function(n,r){return n=n>>>0,r||D(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},l.prototype.readBigInt64LE=J(function(n){n=n>>>0,at(n,"offset");const r=this[n],u=this[n+7];(r===void 0||u===void 0)&&dt(n,this.length-8);const g=this[n+4]+this[n+5]*2**8+this[n+6]*2**16+(u<<24);return(BigInt(g)<<BigInt(32))+BigInt(r+this[++n]*256+this[++n]*65536+this[++n]*16777216)}),l.prototype.readBigInt64BE=J(function(n){n=n>>>0,at(n,"offset");const r=this[n],u=this[n+7];(r===void 0||u===void 0)&&dt(n,this.length-8);const g=(r<<24)+this[++n]*2**16+this[++n]*2**8+this[++n];return(BigInt(g)<<BigInt(32))+BigInt(this[++n]*16777216+this[++n]*65536+this[++n]*256+u)}),l.prototype.readFloatLE=function(n,r){return n=n>>>0,r||D(n,4,this.length),e.read(this,n,!0,23,4)},l.prototype.readFloatBE=function(n,r){return n=n>>>0,r||D(n,4,this.length),e.read(this,n,!1,23,4)},l.prototype.readDoubleLE=function(n,r){return n=n>>>0,r||D(n,8,this.length),e.read(this,n,!0,52,8)},l.prototype.readDoubleBE=function(n,r){return n=n>>>0,r||D(n,8,this.length),e.read(this,n,!1,52,8)};function N(h,n,r,u,g,m){if(!l.isBuffer(h))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>g||n<m)throw new RangeError('"value" argument is out of bounds');if(r+u>h.length)throw new RangeError("Index out of range")}l.prototype.writeUintLE=l.prototype.writeUIntLE=function(n,r,u,g){if(n=+n,r=r>>>0,u=u>>>0,!g){const I=Math.pow(2,8*u)-1;N(this,n,r,u,I,0)}let m=1,w=0;for(this[r]=n&255;++w<u&&(m*=256);)this[r+w]=n/m&255;return r+u},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(n,r,u,g){if(n=+n,r=r>>>0,u=u>>>0,!g){const I=Math.pow(2,8*u)-1;N(this,n,r,u,I,0)}let m=u-1,w=1;for(this[r+m]=n&255;--m>=0&&(w*=256);)this[r+m]=n/w&255;return r+u},l.prototype.writeUint8=l.prototype.writeUInt8=function(n,r,u){return n=+n,r=r>>>0,u||N(this,n,r,1,255,0),this[r]=n&255,r+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(n,r,u){return n=+n,r=r>>>0,u||N(this,n,r,2,65535,0),this[r]=n&255,this[r+1]=n>>>8,r+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(n,r,u){return n=+n,r=r>>>0,u||N(this,n,r,2,65535,0),this[r]=n>>>8,this[r+1]=n&255,r+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(n,r,u){return n=+n,r=r>>>0,u||N(this,n,r,4,4294967295,0),this[r+3]=n>>>24,this[r+2]=n>>>16,this[r+1]=n>>>8,this[r]=n&255,r+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(n,r,u){return n=+n,r=r>>>0,u||N(this,n,r,4,4294967295,0),this[r]=n>>>24,this[r+1]=n>>>16,this[r+2]=n>>>8,this[r+3]=n&255,r+4};function ii(h,n,r,u,g){li(n,u,g,h,r,7);let m=Number(n&BigInt(4294967295));h[r++]=m,m=m>>8,h[r++]=m,m=m>>8,h[r++]=m,m=m>>8,h[r++]=m;let w=Number(n>>BigInt(32)&BigInt(4294967295));return h[r++]=w,w=w>>8,h[r++]=w,w=w>>8,h[r++]=w,w=w>>8,h[r++]=w,r}function ni(h,n,r,u,g){li(n,u,g,h,r,7);let m=Number(n&BigInt(4294967295));h[r+7]=m,m=m>>8,h[r+6]=m,m=m>>8,h[r+5]=m,m=m>>8,h[r+4]=m;let w=Number(n>>BigInt(32)&BigInt(4294967295));return h[r+3]=w,w=w>>8,h[r+2]=w,w=w>>8,h[r+1]=w,w=w>>8,h[r]=w,r+8}l.prototype.writeBigUInt64LE=J(function(n,r=0){return ii(this,n,r,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=J(function(n,r=0){return ni(this,n,r,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(n,r,u,g){if(n=+n,r=r>>>0,!g){const L=Math.pow(2,8*u-1);N(this,n,r,u,L-1,-L)}let m=0,w=1,I=0;for(this[r]=n&255;++m<u&&(w*=256);)n<0&&I===0&&this[r+m-1]!==0&&(I=1),this[r+m]=(n/w>>0)-I&255;return r+u},l.prototype.writeIntBE=function(n,r,u,g){if(n=+n,r=r>>>0,!g){const L=Math.pow(2,8*u-1);N(this,n,r,u,L-1,-L)}let m=u-1,w=1,I=0;for(this[r+m]=n&255;--m>=0&&(w*=256);)n<0&&I===0&&this[r+m+1]!==0&&(I=1),this[r+m]=(n/w>>0)-I&255;return r+u},l.prototype.writeInt8=function(n,r,u){return n=+n,r=r>>>0,u||N(this,n,r,1,127,-128),n<0&&(n=255+n+1),this[r]=n&255,r+1},l.prototype.writeInt16LE=function(n,r,u){return n=+n,r=r>>>0,u||N(this,n,r,2,32767,-32768),this[r]=n&255,this[r+1]=n>>>8,r+2},l.prototype.writeInt16BE=function(n,r,u){return n=+n,r=r>>>0,u||N(this,n,r,2,32767,-32768),this[r]=n>>>8,this[r+1]=n&255,r+2},l.prototype.writeInt32LE=function(n,r,u){return n=+n,r=r>>>0,u||N(this,n,r,4,2147483647,-2147483648),this[r]=n&255,this[r+1]=n>>>8,this[r+2]=n>>>16,this[r+3]=n>>>24,r+4},l.prototype.writeInt32BE=function(n,r,u){return n=+n,r=r>>>0,u||N(this,n,r,4,2147483647,-2147483648),n<0&&(n=4294967295+n+1),this[r]=n>>>24,this[r+1]=n>>>16,this[r+2]=n>>>8,this[r+3]=n&255,r+4},l.prototype.writeBigInt64LE=J(function(n,r=0){return ii(this,n,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=J(function(n,r=0){return ni(this,n,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ri(h,n,r,u,g,m){if(r+u>h.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function si(h,n,r,u,g){return n=+n,r=r>>>0,g||ri(h,n,r,4),e.write(h,n,r,u,23,4),r+4}l.prototype.writeFloatLE=function(n,r,u){return si(this,n,r,!0,u)},l.prototype.writeFloatBE=function(n,r,u){return si(this,n,r,!1,u)};function oi(h,n,r,u,g){return n=+n,r=r>>>0,g||ri(h,n,r,8),e.write(h,n,r,u,52,8),r+8}l.prototype.writeDoubleLE=function(n,r,u){return oi(this,n,r,!0,u)},l.prototype.writeDoubleBE=function(n,r,u){return oi(this,n,r,!1,u)},l.prototype.copy=function(n,r,u,g){if(!l.isBuffer(n))throw new TypeError("argument should be a Buffer");if(u||(u=0),!g&&g!==0&&(g=this.length),r>=n.length&&(r=n.length),r||(r=0),g>0&&g<u&&(g=u),g===u||n.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(u<0||u>=this.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("sourceEnd out of bounds");g>this.length&&(g=this.length),n.length-r<g-u&&(g=n.length-r+u);const m=g-u;return this===n&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,u,g):Uint8Array.prototype.set.call(n,this.subarray(u,g),r),m},l.prototype.fill=function(n,r,u,g){if(typeof n=="string"){if(typeof r=="string"?(g=r,r=0,u=this.length):typeof u=="string"&&(g=u,u=this.length),g!==void 0&&typeof g!="string")throw new TypeError("encoding must be a string");if(typeof g=="string"&&!l.isEncoding(g))throw new TypeError("Unknown encoding: "+g);if(n.length===1){const w=n.charCodeAt(0);(g==="utf8"&&w<128||g==="latin1")&&(n=w)}}else typeof n=="number"?n=n&255:typeof n=="boolean"&&(n=Number(n));if(r<0||this.length<r||this.length<u)throw new RangeError("Out of range index");if(u<=r)return this;r=r>>>0,u=u===void 0?this.length:u>>>0,n||(n=0);let m;if(typeof n=="number")for(m=r;m<u;++m)this[m]=n;else{const w=l.isBuffer(n)?n:l.from(n,g),I=w.length;if(I===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(m=0;m<u-r;++m)this[m+r]=w[m%I]}return this};const ot={};function ae(h,n,r){ot[h]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:n.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${h}]`,this.stack,delete this.name}get code(){return h}set code(g){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:g,writable:!0})}toString(){return`${this.name} [${h}]: ${this.message}`}}}ae("ERR_BUFFER_OUT_OF_BOUNDS",function(h){return h?`${h} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ae("ERR_INVALID_ARG_TYPE",function(h,n){return`The "${h}" argument must be of type number. Received type ${typeof n}`},TypeError),ae("ERR_OUT_OF_RANGE",function(h,n,r){let u=`The value of "${h}" is out of range.`,g=r;return Number.isInteger(r)&&Math.abs(r)>4294967296?g=ai(String(r)):typeof r=="bigint"&&(g=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(g=ai(g)),g+="n"),u+=` It must be ${n}. Received ${g}`,u},RangeError);function ai(h){let n="",r=h.length;const u=h[0]==="-"?1:0;for(;r>=u+4;r-=3)n=`_${h.slice(r-3,r)}${n}`;return`${h.slice(0,r)}${n}`}function hr(h,n,r){at(n,"offset"),(h[n]===void 0||h[n+r]===void 0)&&dt(n,h.length-(r+1))}function li(h,n,r,u,g,m){if(h>r||h<n){const w=typeof n=="bigint"?"n":"";let I;throw m>3?n===0||n===BigInt(0)?I=`>= 0${w} and < 2${w} ** ${(m+1)*8}${w}`:I=`>= -(2${w} ** ${(m+1)*8-1}${w}) and < 2 ** ${(m+1)*8-1}${w}`:I=`>= ${n}${w} and <= ${r}${w}`,new ot.ERR_OUT_OF_RANGE("value",I,h)}hr(u,g,m)}function at(h,n){if(typeof h!="number")throw new ot.ERR_INVALID_ARG_TYPE(n,"number",h)}function dt(h,n,r){throw Math.floor(h)!==h?(at(h,r),new ot.ERR_OUT_OF_RANGE(r||"offset","an integer",h)):n<0?new ot.ERR_BUFFER_OUT_OF_BOUNDS:new ot.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${n}`,h)}const cr=/[^+/0-9A-Za-z-_]/g;function ur(h){if(h=h.split("=")[0],h=h.trim().replace(cr,""),h.length<2)return"";for(;h.length%4!==0;)h=h+"=";return h}function le(h,n){n=n||1/0;let r;const u=h.length;let g=null;const m=[];for(let w=0;w<u;++w){if(r=h.charCodeAt(w),r>55295&&r<57344){if(!g){if(r>56319){(n-=3)>-1&&m.push(239,191,189);continue}else if(w+1===u){(n-=3)>-1&&m.push(239,191,189);continue}g=r;continue}if(r<56320){(n-=3)>-1&&m.push(239,191,189),g=r;continue}r=(g-55296<<10|r-56320)+65536}else g&&(n-=3)>-1&&m.push(239,191,189);if(g=null,r<128){if((n-=1)<0)break;m.push(r)}else if(r<2048){if((n-=2)<0)break;m.push(r>>6|192,r&63|128)}else if(r<65536){if((n-=3)<0)break;m.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((n-=4)<0)break;m.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return m}function fr(h){const n=[];for(let r=0;r<h.length;++r)n.push(h.charCodeAt(r)&255);return n}function gr(h,n){let r,u,g;const m=[];for(let w=0;w<h.length&&!((n-=2)<0);++w)r=h.charCodeAt(w),u=r>>8,g=r%256,m.push(g),m.push(u);return m}function hi(h){return t.toByteArray(ur(h))}function vt(h,n,r,u){let g;for(g=0;g<u&&!(g+r>=n.length||g>=h.length);++g)n[g+r]=h[g];return g}function Y(h,n){return h instanceof n||h!=null&&h.constructor!=null&&h.constructor.name!=null&&h.constructor.name===n.name}function he(h){return h!==h}const dr=function(){const h="0123456789abcdef",n=new Array(256);for(let r=0;r<16;++r){const u=r*16;for(let g=0;g<16;++g)n[u+g]=h[r]+h[g]}return n}();function J(h){return typeof BigInt>"u"?mr:h}function mr(){throw new Error("BigInt not supported")}})(ee);const re=/^ttf:\/\/(.+)#(.+)$/,je="geostyler-mark-symbolizer";class S{static getRgbaColor(t,e){if(lt(t)&&(t=S.evaluateStringFunction(t)),typeof t!="string")return;if(t.startsWith("rgba("))return t;if(!/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t))return;const s=parseInt(t.slice(1,3),16),a=parseInt(t.slice(3,5),16),c=parseInt(t.slice(5,7),16);return bt(e)&&(e=S.evaluateNumberFunction(e)),e<0&&(e=1),"rgba("+s+", "+a+", "+c+", "+e+")"}static splitRgbaColor(t){const e=t.substring(t.indexOf("(")+1,t.lastIndexOf(")")).split(/,\s*/),i=parseInt(e[0],10),s=parseInt(e[1],10),a=parseInt(e[2],10),c=parseFloat(e[3]);return[i,s,a,c]}static getHexColor(t){if(t.startsWith("#"))return t;if(t.startsWith("rgb")){const e=S.splitRgbaColor(t);return S.getHexCodeFromRgbArray(e)}else if(He[t.toLocaleLowerCase()]!==void 0){const e=He[t.toLocaleLowerCase()];return S.getHexCodeFromRgbArray(e)}else return}static getHexCodeFromRgbArray(t){return"#"+t.map((e,i)=>{const s=e.toString(16);return i<3?s.length===1?"0"+s:s:""}).join("")}static getOpacity(t){if(!t.startsWith("rgba("))return;const e=S.splitRgbaColor(t);if(e.length===4)return e[3]}static getTextFont(t){const e=t.fontWeight??"normal",i=t.fontStyle??"normal",s=t.size,a=t.font;return e+" "+i+" "+s+"px "+(a==null?void 0:a.join(", "))}static getIsFontGlyphBased(t){return re.test(t.wellKnownName)}static getIsMarkSymbolizerFont(t){if(!t)return!1;const e=je;return t.substring(t.length-e.length,t.length)===e}static getTextFontForMarkSymbolizer(t){const e=t.wellKnownName.match(re);if(!e)throw new Error(`Could not parse font-based well known name: ${t.wellKnownName}`);const i=e[1];return`Normal ${t.radius||5}px '${i}', ${je}`}static getCharacterForMarkSymbolizer(t){const e=t.wellKnownName.match(re);if(!e)throw new Error(`Could not parse font-based well known name: ${t.wellKnownName}`);return String.fromCharCode(parseInt(e[2],16))}static getFontNameFromOlFont(t){const e=t.match(/(?:\d+\S+) '?"?([^,'"]+)/);if(!e)throw new Error(`Could not find font family name in the following string: ${t}`);return e[1]}static getSizeFromOlFont(t){const e=t.match(/(?:(\d+)px)/);return e?parseInt(e[1],10):0}static createIconStyleFromSvg(t){const e=new Blob([t],{type:"image/svg+xml"}),i=URL.createObjectURL(e),s=new qe({image:new Ye({src:i,crossOrigin:"anonymous",scale:1})}),a=new Image;return a.onload=()=>{URL.revokeObjectURL(i)},a.src=i,s}static getBase64EncodedSvg(t){return"data:image/svg+xml;base64,"+ee.Buffer.from(t).toString("base64")}static getBase64DecodedSvg(t){return ee.Buffer.from(t.replace("data:image/svg+xml;base64,",""),"base64").toString("utf-8")}static resolveAttributeTemplate(t,e,i="n.v.",s=(a,c)=>c){let a="\\{\\{",c="\\}\\}",l=new RegExp(a+"(.*?)"+c,"g"),f=e.match(l);return f&&f.forEach(d=>{let p=0;for(let[_,y]of Object.entries(t.getProperties()))if(d.slice(2,d.length-2).toLowerCase()===_.toLowerCase()){e=e.replace(d,s(_,y));break}else p++;p===Object.keys(t.getProperties()).length&&(e=e.replace(d,i))}),e}static evaluateFunction(t,e){if(t.name==="property"){if(!e)throw new Error(`Could not evalute 'property' function. Feature ${e} is not defined.`);return lt(t.args[0])?e==null?void 0:e.get(S.evaluateStringFunction(t.args[0],e)):e==null?void 0:e.get(t.args[0])}if(ce(t))return S.evaluateUnknownFunction(t,e);if(lt(t))return S.evaluateStringFunction(t,e);if(bt(t))return S.evaluateNumberFunction(t,e);if(mt(t))return S.evaluateBooleanFunction(t,e)}static evaluateBooleanFunction(t,e){const i=t.args.map(s=>B(s)?S.evaluateFunction(s,e):s);switch(t.name){case"all":return i.map(c=>this.evaluateBooleanFunction(c,e)).every(c=>c===!0);case"any":return i.map(c=>this.evaluateBooleanFunction(c,e)).some(c=>c===!0);case"between":return i[0]>=i[1]&&i[0]<=i[2];case"double2bool":return!1;case"equalTo":return i[0]===i[1];case"greaterThan":return i[0]>i[1];case"greaterThanOrEqualTo":return i[0]>=i[1];case"in":return i.slice(1).includes(i[0]);case"lessThan":return i[0]<i[1];case"lessThanOrEqualTo":return i[0]<=i[1];case"not":return!i[0];case"notEqualTo":return i[0]!==i[1];case"parseBoolean":return!!i[0];case"strEndsWith":return i[0].endsWith(i[1]);case"strEqualsIgnoreCase":return i[0].toLowerCase()===i[1].toLowerCase();case"strMatches":const a=i[1].match(/\/(.*?)\/([gimy]{0,4})$/);return a&&a.length===3?new RegExp(a[1],a[2]).test(i[0]):!1;case"strStartsWith":return i[0].startsWith(i[1]);default:return!1}}static evaluateNumberFunction(t,e){if(t.name==="pi")return Math.PI;if(t.name==="random")return Math.random();const i=t.args.map(s=>B(s)?S.evaluateFunction(s,e):s);switch(t.name){case"abs":return Math.abs(i[0]);case"acos":return Math.acos(i[0]);case"add":return i[0]+i[1];case"asin":return Math.asin(i[0]);case"atan":return Math.atan(i[0]);case"atan2":return i[0];case"ceil":return Math.ceil(i[0]);case"cos":return Math.cos(i[0]);case"div":return i[0]/i[1];case"exp":return Math.exp(i[0]);case"floor":return Math.floor(i[0]);case"log":return Math.log(i[0]);case"max":return Math.max(...i);case"min":return Math.min(...i);case"modulo":return i[0]%i[1];case"mul":return i[0]*i[1];case"pow":return Math.pow(i[0],i[1]);case"rint":return i[0];case"round":return Math.round(i[0]);case"sin":return Math.sin(i[0]);case"sqrt":return Math.sqrt(i[0]);case"strIndexOf":return i[0].indexOf(i[1]);case"strLastIndexOf":return i[0].lastIndexOf(i[1]);case"strLength":return i[0].length;case"sub":return i[0]-i[1];case"tan":return Math.tan(i[0]);case"toDegrees":return i[0]*(180/Math.PI);case"toRadians":return i[0]*(Math.PI/180);default:return i[0]}}static evaluateUnknownFunction(t,e){const i=t.args.map(s=>B(s)?S.evaluateFunction(s,e):s);switch(t.name){case"property":return e==null?void 0:e.get(i[0]);case"case":const s=i;let a;for(let c=0;c<s.length;c++){const l=s[c];if(c===s.length-1){a=l;break}else if(l.case===!0){a=l.value;break}else if(S.evaluateBooleanFunction(l.case,e)){a=l.value;break}}return a;default:return i[0]}}static evaluateStringFunction(t,e){var a;const i=t.args.map(c=>B(c)?S.evaluateFunction(c,e):c);switch(t.name){case"numberFormat":return i[0];case"strAbbreviate":return i[0];case"strCapitalize":var s=i[0].toLowerCase().split(" ");for(let c of s)c=c.charAt(0).toUpperCase()+c.substring(1);return s.join(" ");case"strConcat":return i.join();case"strDefaultIfBlank":return((a=i[0])==null?void 0:a.length)<1?i[1]:i[0];case"strReplace":return i[3]===!0?i[0].replaceAll(i[1],i[2]):i[0].replace(i[1],i[2]);case"strStripAccents":return i[0].normalize("NFKD").replace(/[\u0300-\u036f]/g,"");case"strSubstring":return i[0].substring(i[1],i[2]);case"strSubstringStart":return i[0].substring(i[1]);case"strToLowerCase":return i[0].toLowerCase();case"strToUpperCase":return i[0].toUpperCase();case"strTrim":return i[0].trim();default:return i[0]}}static containsGeoStylerFunctions(t){return t.rules.some(e=>{var c,l,f,d;const i=Array.isArray(e.filter)&&((c=e.filter)==null?void 0:c.some(B)),s=(l=e.symbolizers)==null?void 0:l.some(p=>Object.values(p).some(B)),a=B((f=e==null?void 0:e.scaleDenominator)==null?void 0:f.max)||B((d=e==null?void 0:e.scaleDenominator)==null?void 0:d.min);return i||s||a})}}const Je={arrow:'d="M 0,-10 L 5,-5 L 2.5,-5 L 2.5,10 L -2.5,10 L -2.5,-5 L -5,-5 L 0,-10 Z"',arrowhead:'d="M -10 -10 L 0 0 L -10 10"',asterisk_fill:'d="M -1.5,-10 L 1.5,-10L 1.5,-3.939 L 6.011,-8.132 L 8.132,-6.011 L 3.939,-1.5 L 10,-1.5 L 10,1.5 L 3.939,1.5 L 8.132,6.011 L 6.011,8.132 L 1.5,3.939 L 1.5,10 L -1.5,10 L -1.5,3.939 L -6.011,8.132 L -8.132,6.011 L -3.939,1.5 L -10,1.5 L -10,-1.5 L -3.939,-1.5 L -8.132,-6.011 L -6.011,-8.132 L -1.5,-3.939 L -1.5,-10 Z"',backslash:'d="M -12 -12 L 12 12"',carrow:'d="M -10 10 L 0 -10 L 10 10 Z"',circle:'cx="0" cy="0" r="10"',cross:'d="M -12 0 L 12 0 M 0 -12 L 0 12"',cross_fill:'d="M -10,-2 L -10,-2 L -10,2 L -2,2 L -2,10 L 2,10 L 2,2 L 10,2 L 10,-2 L 2,-2 L 2,-10 L -2,-10 L -2,-2 L -10,-2 Z"',cross2:'d="M -12 -12 L 12 12 M 12 -12 L -12 12"',decagon:'points="5.878,8.09 9.511,3.09 9.511,-3.09 5.878,-8.09 0,-10 -5.878,-8.09 -9.511,-3.09 -9.511,3.09 -5.878,8.09 0,10 5.878,8.09"',diagonal_half_square:'points="-10,-10 10,10 -10,10 -10,-10"',diamond:'points="-10,0 0,10 10,0 0,-10 -10,0"',equilateral_triangle:'points="-8.66,5 8.66,5 0,-10 -8.66,5"',filled_arrowhead:'d="M 0,0 L -10,10 L -10,-10 L 0,0 Z"',half_arc:'d="M -10 0 A -10 -10 0 0 1 10 0"',half_square:'points="-10,-10 0,-10 0,10 -10,10 -10,-10"',heart:'d="M -9.5 -2 A 1 1 0 0 1 0 -7.5 A 1 1 0 0 1 9.5 -2 L 0 10 Z"',hexagon:'points="-8.66,-5 -8.66,5 0,10 8.66,5 8.66,-5 0,-10 -8.66,-5"',horline:'d="M -12 0 L 12 0"',left_half_triangle:'points="0,10 10,10 0,-10 0,10"',line:'d="M 0 -12 L 0 12"',oarrow:'d="M -10 10 L 0 -10 L 10 10"',octagon:'points="-4.142,10 4.142,10 10,4.142 10,-4.142 4.142,-10 -4.142,-10 -10,-4.142 -10,4.142 -4.142,10"',parallelogram_left:'points="10,5 5,-5 -10,-5 -5,5 10,5"',parallelogram_right:'points="5,5 10,-5 -5,-5 -10,5 5,5"',pentagon:'points="-9.511,-3.09 -5.878,8.09 5.878,8.09 9.511,-3.09 0,-10 -9.511,-3.09"',quarter_arc:'d="M 0 -10 A 10 10 0 0 0 -10 0"',quarter_circle:'d="M 0 -10 A 10 10 0 0 0 -10 0 L 0 0 Z"',quarter_square:'points="-10,-10 0,-10 0,0 -10,0 -10,-10"',right_half_triangle:'points="-10,10 0,10 0,-10 -10,10"',rounded_square:'x="-10" y="-10" width="20" height="20" rx="2.5" ry="2.5"',semi_circle:'d="M -10 0 A -10 -10 0 0 1 10 0 L 0 0 Z"',shield:'points="10,5 10,-10 -10,-10 -10,5 0,10 10,5"',slash:'d="M 12 -12 L -12 12"',square:'points="-10,-10 10,-10 10,10 -10,10"',square_with_corners:'points="-6.072,10 6.072,10 10,6.072 10,-6.072 6.072,-10 -6.072,-10 -10,-6.072 -10,6.072 -6.072,10"',star:'d="M -2.24514,-3.09017 -9.51057,-3.09017 -3.63271,1.18034 -5.87785,8.09017 0,3.81966 5.87785,8.09017 3.63271,1.18034 9.51057,-3.09017 2.24514,-3.09017 0,-10 -2.24514,-3.09017 Z"',star_diamond:'d="M -2.70091,-2.70091 -10,0 -2.70091,2.70091 0,10 2.70091,2.70091 10,0 2.70091,-2.70091 0,-10 Z"',third_arc:'d="M 0 -10 A 10 10 0 0 0 -5 8.66"',third_circle:'d="M 0 -10 A 10 10 0 0 0 -5 8.66 L 0 0 Z"',trapezoid:'points="5,-5 10,5 -10,5 -5,-5 5,-5"',triangle:'points="-10,10 10,10 0,-10 -10,10"'},$n=o=>{switch(o){case"shape://backslash":return"backslash";case"shape://carrow":return"carrow";case"shape://dot":return"circle";case"shape://horline":return"horline";case"shape://oarrow":return"oarrow";case"shape://plus":return"cross";case"shape://slash":return"slash";case"shape://times":case"x":return"cross2";case"shape://vertline":return"line";default:return o}},Ke=o=>o in Je,qn=(o="circle",t={dimensions:40})=>{const{dimensions:e,fill:i,fillOpacity:s,stroke:a,strokeWidth:c,strokeOpacity:l}=t;if(!Ke(o))throw new Error("Unknown shape: "+o);const f='<svg xmlns="http://www.w3.org/2000/svg" width="'+e+'" height="'+e+'" viewBox = "-12 -12 24 24">',d="</svg>";let p=Je[o]+" ";p.startsWith("points=")?p='<polygon id="'+o+'" '+p:p.startsWith("x=")?p='<rect id="'+o+'" '+p:p.startsWith("cx=")?p='<circle id="'+o+'" '+p:p='<path id="'+o+'" '+p;let _="";return i&&(_+="fill:"+i+"; "),s&&(_+="fill-opacity:"+s+"; "),a&&(_+="stroke:"+a+"; "),c!==void 0&&c!==0&&(_+="stroke-width:"+c+"; "),l&&(_+="stroke-opacity:"+l+"; "),p+='style="'+_.trim()+'" />',f+p+d},Ze=o=>{try{const e=new DOMParser().parseFromString(o,"application/xml");if(e.querySelector("parsererror"))throw new Error("Invalid XML format");const s=e.querySelector("svg");if(!s)throw new Error("<svg> element not found");const a=s==null?void 0:s.getAttribute("width");if(!a)throw new Error("<svg> element must include dimensions (no width attribute exists)");const c=Array.from(s==null?void 0:s.children).find(y=>y instanceof Element),l=(c==null?void 0:c.getAttribute("id"))??"",d=((c==null?void 0:c.getAttribute("style"))??"").split(";").filter(y=>y.trim()!==""),p={};for(const y of d){const[x,C]=y.split(":").map(F=>F.trim());x&&C&&(p[x]=C)}return{id:l,dimensions:Number(a),...p.fill&&{fill:p.fill},...p["fill-opacity"]&&{fillOpacity:Number(p["fill-opacity"])},...p.stroke&&{stroke:p.stroke},...p["stroke-width"]&&{strokeWidth:Number(p["stroke-width"])},...p["stroke-opacity"]&&{strokeOpacity:Number(p["stroke-opacity"])}}}catch{throw new Error("Error parsing SVG")}};class Xn{drawCustom(t,e,i,s,a){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,i){}drawFeature(t,e,i){}drawGeometryCollection(t,e,i){}drawLineString(t,e,i){}drawMultiLineString(t,e,i){}drawMultiPoint(t,e,i){}drawMultiPolygon(t,e,i){}drawPoint(t,e,i){}drawPolygon(t,e,i){}drawText(t,e,i){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}var Yn=Xn;class Hn extends Yn{constructor(t,e,i,s,a,c,l){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=s,this.transformRotation_=s?ji(Math.atan2(s[1],s[0]),10):0,this.viewRotation_=a,this.squaredTolerance_=c,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Rt()}drawImages_(t,e,i,s){if(!this.image_)return;const a=ut(t,e,i,s,this.transform_,this.pixelCoordinates_),c=this.context_,l=this.tmpLocalTransform_,f=c.globalAlpha;this.imageOpacity_!=1&&(c.globalAlpha=f*this.imageOpacity_);let d=this.imageRotation_;this.transformRotation_===0&&(d-=this.viewRotation_),this.imageRotateWithView_&&(d+=this.viewRotation_);for(let p=0,_=a.length;p<_;p+=2){const y=a[p]-this.imageAnchorX_,x=a[p+1]-this.imageAnchorY_;if(d!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const C=y+this.imageAnchorX_,F=x+this.imageAnchorY_;we(l,C,F,1,1,d,-C,-F),c.save(),c.transform.apply(c,l),c.translate(C,F),c.scale(this.imageScale_[0],this.imageScale_[1]),c.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),c.restore()}else c.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,y,x,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(c.globalAlpha=f)}drawText_(t,e,i,s){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const a=ut(t,e,i,s,this.transform_,this.pixelCoordinates_),c=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);e<i;e+=s){const f=a[e]+this.textOffsetX_,d=a[e+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(c.save(),c.translate(f-this.textOffsetX_,d-this.textOffsetY_),c.rotate(l),c.translate(this.textOffsetX_,this.textOffsetY_),c.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&c.strokeText(this.text_,0,0),this.textFillState_&&c.fillText(this.text_,0,0),c.restore()):(this.textStrokeState_&&c.strokeText(this.text_,f,d),this.textFillState_&&c.fillText(this.text_,f,d))}}moveToLineTo_(t,e,i,s,a){const c=this.context_,l=ut(t,e,i,s,this.transform_,this.pixelCoordinates_);c.moveTo(l[0],l[1]);let f=l.length;a&&(f-=2);for(let d=2;d<f;d+=2)c.lineTo(l[d],l[d+1]);return a&&c.closePath(),i}drawRings_(t,e,i,s){for(let a=0,c=i.length;a<c;++a)e=this.moveToLineTo_(t,e,i[a],s,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ht(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=cn(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],s=e[3]-e[1],a=Math.sqrt(i*i+s*s),c=this.context_;c.beginPath(),c.arc(e[0],e[1],a,0,2*Math.PI),this.fillState_&&c.fill(),this.strokeState_&&c.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,s=e.length;i<s;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ht(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(ht(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,s=t.getFlatCoordinates();let a=0;const c=t.getEnds(),l=t.getStride();i.beginPath();for(let f=0,d=c.length;f<d;++f)a=this.moveToLineTo_(s,a,c[f],l,!1);i.stroke()}if(this.text_!==""){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ht(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ht(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let s=0;const a=t.getEndss(),c=t.getStride();e.beginPath();for(let l=0,f=a.length;l<f;++l){const d=a[l];s=this.drawRings_(i,s,d,c)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),fe(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,s=t.textAlign?t.textAlign:We;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=s&&(i.textAlign=s,e.textAlign=s),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=s,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:s,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const i=t.getColor();this.fillState_={fillStyle:nt(i||It)}}if(!e)this.strokeState_=null;else{const i=e.getColor(),s=e.getLineCap(),a=e.getLineDash(),c=e.getLineDashOffset(),l=e.getLineJoin(),f=e.getWidth(),d=e.getMiterLimit(),p=a||Ne;this.strokeState_={lineCap:s!==void 0?s:Et,lineDash:this.pixelRatio_===1?p:p.map(_=>_*this.pixelRatio_),lineDashOffset:(c||Ue)*this.pixelRatio_,lineJoin:l!==void 0?l:Ot,lineWidth:(f!==void 0?f:Ht)*this.pixelRatio_,miterLimit:d!==void 0?d:Xt,strokeStyle:nt(i||Yt)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const i=t.getPixelRatio(this.pixelRatio_),s=t.getAnchor(),a=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=s[0]*i,this.imageAnchorY_=s[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=a[0],this.imageOriginY_=a[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const c=t.getScaleArray();this.imageScale_=[c[0]*this.pixelRatio_/i,c[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const x=e.getColor();this.textFillState_={fillStyle:nt(x||It)}}const i=t.getStroke();if(!i)this.textStrokeState_=null;else{const x=i.getColor(),C=i.getLineCap(),F=i.getLineDash(),k=i.getLineDashOffset(),E=i.getLineJoin(),R=i.getWidth(),M=i.getMiterLimit();this.textStrokeState_={lineCap:C!==void 0?C:Et,lineDash:F||Ne,lineDashOffset:k||Ue,lineJoin:E!==void 0?E:Ot,lineWidth:R!==void 0?R:Ht,miterLimit:M!==void 0?M:Xt,strokeStyle:nt(x||Yt)}}const s=t.getFont(),a=t.getOffsetX(),c=t.getOffsetY(),l=t.getRotateWithView(),f=t.getRotation(),d=t.getScaleArray(),p=t.getText(),_=t.getTextAlign(),y=t.getTextBaseline();this.textState_={font:s!==void 0?s:bn,textAlign:_!==void 0?_:We,textBaseline:y!==void 0?y:An},this.text_=p!==void 0?Array.isArray(p)?p.reduce((x,C,F)=>x+=F%2?" ":C,""):p:"",this.textOffsetX_=a!==void 0?this.pixelRatio_*a:0,this.textOffsetY_=c!==void 0?this.pixelRatio_*c:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=f!==void 0?f:0,this.textScale_=[this.pixelRatio_*d[0],this.pixelRatio_*d[1]]}}}var Vn=Hn;function jn(o,t){const e=o.canvas;t=t||{};const i=t.pixelRatio||Sn,s=t.size;s&&(e.width=s[0]*i,e.height=s[1]*i,e.style.width=s[0]+"px",e.style.height=s[1]+"px");const a=[0,0,e.width,e.height],c=bi(Rt(),i,i);return new Vn(o,i,a,c,0)}class se extends Tt{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new se(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Lt(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=pt(t,K.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?Jn(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function Jn(o){if(typeof o=="function")return o;let t;return Array.isArray(o)?t=o:(_t(typeof o.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[o]),function(){return t}}var Kn=se;class oe{constructor(t){U(this,"unsupportedProperties",{Symbolizer:{MarkSymbolizer:{avoidEdges:"none",blur:"none",offsetAnchor:"none",pitchAlignment:"none",pitchScale:"none"},FillSymbolizer:{antialias:"none",opacity:{support:"none",info:"Use fillOpacity instead."}},IconSymbolizer:{allowOverlap:"none",anchor:"none",avoidEdges:"none",color:"none",haloBlur:"none",haloColor:"none",haloWidth:"none",keepUpright:"none",offsetAnchor:"none",size:{support:"partial",info:"Will set/get the width of the ol Icon."},optional:"none",padding:"none",pitchAlignment:"none",rotationAlignment:"none",textFit:"none",textFitPadding:"none"},LineSymbolizer:{blur:"none",gapWidth:"none",gradient:"none",miterLimit:"none",roundLimit:"none",spacing:"none",graphicFill:"none",graphicStroke:"none",perpendicularOffset:"none"},RasterSymbolizer:"none",TextSymbolizer:{anchor:"none",placement:{support:"partial",info:"point and line supported. line-center will be mapped to line."}}},Function:{double2bool:{support:"none",info:"Always returns false"},atan2:{support:"none",info:"Currently returns the first argument"},rint:{support:"none",info:"Currently returns the first argument"},numberFormat:{support:"none",info:"Currently returns the first argument"},strAbbreviate:{support:"none",info:"Currently returns the first argument"}}});U(this,"title","OpenLayers Style Parser");U(this,"olIconStyleCache",{});U(this,"OlStyleConstructor",qe);U(this,"OlStyleImageConstructor",Nt);U(this,"OlStyleFillConstructor",ze);U(this,"OlStyleStrokeConstructor",Tn);U(this,"OlStyleTextConstructor",Mn);U(this,"OlStyleCircleConstructor",Ln);U(this,"OlStyleIconConstructor",Ye);U(this,"OlStyleRegularshapeConstructor",Ge);U(this,"isOlParserStyleFct",t=>typeof t=="function");t&&(this.OlStyleConstructor=t.style.Style,this.OlStyleImageConstructor=t.style.Image,this.OlStyleFillConstructor=t.style.Fill,this.OlStyleStrokeConstructor=t.style.Stroke,this.OlStyleTextConstructor=t.style.Text,this.OlStyleCircleConstructor=t.style.Circle,this.OlStyleIconConstructor=t.style.Icon,this.OlStyleRegularshapeConstructor=t.style.RegularShape)}getPointSymbolizerFromOlStyle(t){let e;if(t.getImage()instanceof this.OlStyleCircleConstructor){const i=t.getImage(),s=i.getFill(),a=i.getStroke(),c=i.getDisplacement();e={kind:"Mark",wellKnownName:"circle",color:s?S.getHexColor(s.getColor()):void 0,opacity:i.getOpacity()!==1?i.getOpacity():void 0,fillOpacity:s?S.getOpacity(s.getColor()):void 0,radius:i.getRadius()!==0?i.getRadius():5,strokeColor:a?a.getColor():void 0,strokeOpacity:a?S.getOpacity(a.getColor()):void 0,strokeWidth:a?a.getWidth():void 0,offset:c[0]||c[1]?c:void 0}}else if(t.getImage()instanceof this.OlStyleRegularshapeConstructor){const i=t.getImage(),s=i.getFill(),a=i.getStroke(),c=i.getRadius(),l=i.getRadius2(),f=i.getPoints(),d=i.getAngle(),p=i.getDisplacement(),_={kind:"Mark",color:s?S.getHexColor(s.getColor()):void 0,opacity:i.getOpacity()!==1?i.getOpacity():void 0,fillOpacity:s?S.getOpacity(s.getColor()):void 0,strokeColor:a?a.getColor():void 0,strokeOpacity:a?S.getOpacity(a.getColor()):void 0,strokeWidth:a?a.getWidth():void 0,radius:c!==0?c:5,rotate:i.getRotation()/Math.PI*180,offset:p[0]||p[1]?p:void 0};switch(f){case 2:switch(d){case 0:_.wellKnownName="shape://vertline";break;case Math.PI/2:_.wellKnownName="shape://horline";break;case Math.PI/4:_.wellKnownName="shape://slash";break;case 2*Math.PI-Math.PI/4:_.wellKnownName="shape://backslash";break}break;case 3:switch(d){case 0:_.wellKnownName="triangle";break;case Math.PI/2:_.wellKnownName="shape://carrow";break}break;case 4:Number.isFinite(l)?i.getAngle()===0?_.wellKnownName="cross":_.wellKnownName="x":_.wellKnownName="square";break;case 5:_.wellKnownName="star";break;default:throw new Error("Could not parse OlStyle. Only 2, 3, 4 or 5 point regular shapes are allowed")}e=_}else if(t.getText()instanceof this.OlStyleTextConstructor){const i=t.getText(),s=i.getFill(),a=i.getStroke(),c=i.getRotation();let l=i.getText()||"a";const f=i.getFont()||"10px sans-serif",d=S.getFontNameFromOlFont(f),p=S.getSizeFromOlFont(f),_=[i.getOffsetX(),i.getOffsetY()];Array.isArray(l)&&(l=l[0]),e={kind:"Mark",wellKnownName:`ttf://${d}#0x${l.charCodeAt(0).toString(16)}`,color:s?S.getHexColor(s.getColor()):void 0,opacity:s?S.getOpacity(s.getColor()):void 0,strokeColor:a?a.getColor():void 0,strokeOpacity:a?S.getOpacity(a.getColor()):void 0,strokeWidth:a?a.getWidth():void 0,radius:p!==0?p:5,rotate:c?c/Math.PI*180:0,offset:_[0]||_[1]?_:void 0}}else{const i=t.getImage(),s=i.getDisplacement();let a=i.getWidth();const c=i.getRotation()/Math.PI*180,l=i.getOpacity();try{const f=S.getBase64DecodedSvg(i.getSrc()),{id:d,dimensions:p,fill:_,stroke:y,strokeWidth:x}=Ze(f),C=y&&S.getOpacity(y)!==1?S.getOpacity(y):void 0;e={kind:"Mark",wellKnownName:d,..._&&{color:_},...l!==void 0&&l!==1&&{opacity:l},...y&&{strokeColor:y.substring(0,7)},...x!==void 0&&{strokeWidth:x},...C!==void 0&&{strokeOpacity:C},...p/2!==0&&{radius:p/2},...c!==void 0&&c!==0&&{rotate:c},...(s[0]||s[1])&&{offset:s}}}catch{e={kind:"Icon",image:this.getImageFromIconStyle(i),opacity:l<1?l:void 0,size:a,rotate:c!==0?c:void 0,offset:s[0]||s[1]?s:void 0}}}return e}getImageFromIconStyle(t){const e=t.getSize();if(Array.isArray(e)){let i=t.offset_;const s=t.offsetOrigin_;if(s&&s!=="top-left")throw new Error(`Offset origin ${s} not supported`);return{source:t.getSrc(),position:i,size:e}}else return t.getSrc()?t.getSrc():void 0}getLineSymbolizerFromOlStyle(t){const e=t.getStroke(),i=e?e.getLineDash():void 0;return{kind:"Line",color:e?S.getHexColor(e.getColor()):void 0,opacity:e?S.getOpacity(e.getColor()):void 0,width:e?e.getWidth():void 0,cap:e?e.getLineCap():"butt",join:e?e.getLineJoin():"miter",dasharray:i||void 0,dashOffset:e?e.getLineDashOffset():void 0}}getFillSymbolizerFromOlStyle(t){const e=t.getFill(),i=t.getStroke(),s=i?i.getLineDash():void 0,a={kind:"Fill"};return e&&(a.color=S.getHexColor(e.getColor())),e&&(a.fillOpacity=S.getOpacity(e.getColor())),i&&(a.outlineColor=S.getHexColor(i.getColor())),s&&(a.outlineDasharray=s),i&&(a.outlineOpacity=S.getOpacity(i.getColor())),i&&i.getWidth()&&(a.outlineWidth=i.getWidth()),a}getTextSymbolizerFromOlStyle(t){const e=t.getText();if(!e)throw new Error("Could not get text from olStyle.");const i=e.getFill(),s=e.getStroke(),a=e.getOffsetX(),c=e.getOffsetY(),l=e.getFont(),f=e.getRotation(),d=e.getOverflow()?e.getOverflow():void 0,p=e.getPlacement(),_=e.getText(),y=Array.isArray(_)?_[0]:_;let x=1/0,C,F,k;if(l){const E=ui(l);if(E["font-weight"]&&(F=E["font-weight"]),E["font-size"]&&(x=parseInt(E["font-size"],10)),E["font-family"]){const R=E["font-family"];C=R==null?void 0:R.map(M=>M.includes(" ")?'"'+M+'"':M)}E["font-style"]&&(k=E["font-style"])}return{kind:"Text",label:y,placement:p,allowOverlap:d,color:i?S.getHexColor(i.getColor()):void 0,size:isFinite(x)?x:void 0,font:C,fontWeight:F||void 0,fontStyle:k||void 0,offset:a!==void 0&&c!==void 0?[a,c]:[0,0],haloColor:s&&s.getColor()?S.getHexColor(s.getColor()):void 0,haloWidth:s?s.getWidth():void 0,rotate:f!==void 0?f/Math.PI*180:void 0}}getSymbolizersFromOlStyle(t){const e=[];return t.forEach(i=>{let s;switch(this.getStyleTypeFromOlStyle(i)){case"Point":i.getText()&&!S.getIsMarkSymbolizerFont(i.getText().getFont())?s=this.getTextSymbolizerFromOlStyle(i):s=this.getPointSymbolizerFromOlStyle(i);break;case"Line":s=this.getLineSymbolizerFromOlStyle(i);break;case"Fill":s=this.getFillSymbolizerFromOlStyle(i);break;default:throw new Error("Failed to parse SymbolizerKind from OpenLayers Style")}e.push(s)}),e}getRuleFromOlStyle(t){let e;const i="OL Style Rule 0";return Array.isArray(t)?e=this.getSymbolizersFromOlStyle(t):e=this.getSymbolizersFromOlStyle([t]),{name:i,symbolizers:e}}getStyleTypeFromOlStyle(t){let e;if(t.getImage()instanceof this.OlStyleImageConstructor)e="Point";else if(t.getText()instanceof this.OlStyleTextConstructor)e="Point";else if(t.getFill()instanceof this.OlStyleFillConstructor)e="Fill";else if(t.getStroke()&&!t.getFill())e="Line";else throw new Error("StyleType could not be detected");return e}olStyleToGeoStylerStyle(t){const e="OL Style",i=this.getRuleFromOlStyle(t);return{name:e,rules:[i]}}readStyle(t){return new Promise(e=>{try{if(this.isOlParserStyleFct(t))e({output:t.__geoStylerStyle});else{t=t;const i=this.olStyleToGeoStylerStyle(t),s=this.checkForUnsupportedProperties(i);e({output:i,unsupportedProperties:s})}}catch(i){e({errors:[i]})}})}writeStyle(t){return new Promise(async e=>{const i=structuredClone(t),s=this.checkForUnsupportedProperties(i);try{const a=await this.getOlStyleTypeFromGeoStylerStyle(i);e({output:a,unsupportedProperties:s,warnings:s&&["Your style contains unsupportedProperties!"]})}catch(a){e({errors:[a]})}})}checkForUnsupportedProperties(t){const e=s=>s[0].toUpperCase()+s.slice(1),i={};if(t.rules.forEach(s=>{s.symbolizers.forEach(a=>{var f,d;const c=e(`${a.kind}Symbolizer`),l=(d=(f=this.unsupportedProperties)==null?void 0:f.Symbolizer)==null?void 0:d[c];l&&(typeof l=="string"?(i.Symbolizer||(i.Symbolizer={}),i.Symbolizer[c]=l):Object.keys(a).forEach(p=>{l[p]&&(i.Symbolizer||(i.Symbolizer={}),i.Symbolizer[c]||(i.Symbolizer[c]={}),i.Symbolizer[c][p]=l[p])}))})}),Object.keys(i).length>0)return i}async getOlStyleTypeFromGeoStylerStyle(t){var s,a,c,l,f,d,p,_;const e=t.rules;if(e.length===1){const y=((a=(s=t==null?void 0:t.rules)==null?void 0:s[0])==null?void 0:a.filter)!==void 0,x=((f=(l=(c=t==null?void 0:t.rules)==null?void 0:c[0])==null?void 0:l.scaleDenominator)==null?void 0:f.min)!==void 0,C=((_=(p=(d=t==null?void 0:t.rules)==null?void 0:d[0])==null?void 0:p.scaleDenominator)==null?void 0:_.max)!==void 0,F=!!(x||C),k=S.containsGeoStylerFunctions(t),E=t.rules[0].symbolizers.length,R=e[0].symbolizers.some(z=>z.kind==="Text"),M=e[0].symbolizers.some(z=>z.kind==="Icon"&&typeof z.image=="string"&&z.image.includes("{{"));return!y&&!F&&!R&&!M&&!k?E===1?await this.geoStylerStyleToOlStyle(t):await this.geoStylerStyleToOlStyleArray(t):await this.geoStylerStyleToOlParserStyleFct(t)}else return await this.geoStylerStyleToOlParserStyleFct(t)}async geoStylerStyleToOlStyle(t){const i=t.rules[0].symbolizers[0];return await this.getOlSymbolizerFromSymbolizer(i)}async geoStylerStyleToOlStyleArray(t){const e=t.rules[0],i=[];return e.symbolizers.forEach(async s=>{const a=await this.getOlSymbolizerFromSymbolizer(s);i.push(a)}),i}async geoStylerStyleToOlParserStyleFct(t){const e=structuredClone(t.rules),s=(a,c)=>{const l=[],f=90.7142857142857,d=Fe.m,p=39.37,_=c*d*p*f;return e.forEach(y=>{var E,R;let x=(E=y==null?void 0:y.scaleDenominator)==null?void 0:E.min,C=(R=y==null?void 0:y.scaleDenominator)==null?void 0:R.max,F=!0;(x||C)&&(x=B(x)?S.evaluateNumberFunction(x):x,C=B(C)?S.evaluateNumberFunction(C):C,x&&_<x&&(F=!1),C&&_>=C&&(F=!1));let k=!1;if(!y.filter)k=!0;else try{k=this.geoStylerFilterToOlParserFilter(a,y.filter)}catch{k=!1}F&&k&&y.symbolizers.forEach(async M=>{M.visibility===!1&&l.push(null),mt(M.visibility)&&(S.evaluateBooleanFunction(M.visibility)||l.push(null));const z=await this.getOlSymbolizerFromSymbolizer(M,a);if(typeof z!="function")l.push(z);else{const W=z(a,c);l.push(W)}})}),l};return s.__geoStylerStyle=t,s}geoStylerFilterToOlParserFilter(t,e){const i={"&&":!0,"||":!0,"!":!0};let s=!0;if(mt(e))return S.evaluateBooleanFunction(e,t);if(e===!0||e===!1)return e;const a=e[0];let c=!1;i[a]&&(c=!0);try{if(c){let l,f;switch(e[0]){case"&&":l=!0,f=e.slice(1),f.forEach(d=>{this.geoStylerFilterToOlParserFilter(t,d)||(l=!1)}),s=l;break;case"||":l=!1,f=e.slice(1),f.forEach(d=>{this.geoStylerFilterToOlParserFilter(t,d)&&(l=!0)}),s=l;break;case"!":s=!this.geoStylerFilterToOlParserFilter(t,e[1]);break;default:throw new Error("Cannot parse Filter. Unknown combination or negation operator.")}}else{let l;B(e[1])?l=S.evaluateFunction(e[1],t):l=t.get(e[1]);let f;switch(B(e[2])?f=S.evaluateFunction(e[2],t):f=e[2],e[0]){case"==":s=""+l==""+f;break;case"*=":typeof f=="string"&&typeof l=="string"&&(f.length>l.length?s=!1:s=l.indexOf(f)!==-1);break;case"!=":s=""+l!=""+f;break;case"<":s=Number(l)<Number(f);break;case"<=":s=Number(l)<=Number(f);break;case">":s=Number(l)>Number(f);break;case">=":s=Number(l)>=Number(f);break;default:throw new Error("Cannot parse Filter. Unknown comparison operator.")}}}catch{throw new Error("Cannot parse Filter. Invalid structure.")}return s}async getOlSymbolizerFromSymbolizer(t,e){let i;switch(t=structuredClone(t),t.kind){case"Mark":i=await this.getOlPointSymbolizerFromMarkSymbolizer(t,e);break;case"Icon":i=await this.getOlIconSymbolizerFromIconSymbolizer(t,e);break;case"Text":i=this.getOlTextSymbolizerFromTextSymbolizer(t,e);break;case"Line":i=this.getOlLineSymbolizerFromLineSymbolizer(t,e);break;case"Fill":i=await this.getOlPolygonSymbolizerFromFillSymbolizer(t,e);break;default:const s=new this.OlStyleFillConstructor({color:"rgba(255,255,255,0.4)"}),a=new this.OlStyleStrokeConstructor({color:"#3399CC",width:1.25});i=new this.OlStyleConstructor({image:new this.OlStyleCircleConstructor({fill:s,stroke:a,radius:5}),fill:s,stroke:a});break}return i}async getOlPointSymbolizerFromMarkSymbolizer(t,e){for(const y of Object.keys(t))B(t[y])&&(t[y]=S.evaluateFunction(t[y],e));const i=t.strokeColor,s=t.strokeOpacity,a=t.strokeWidth,c=t.color,l=t.fillOpacity,f=Number(t.rotate)*Math.PI/180,d=t.offset;let p,_=$n(t.wellKnownName);if(Ke(_)){const y=((t==null?void 0:t.radius)??6)*2,x=t.opacity,C={dimensions:y,...c&&{fill:c},...l&&{fillOpacity:l},...i&&{stroke:i},...a&&{strokeWidth:a},...s&&{strokeOpacity:s}},F=qn(_,C);p=new this.OlStyleConstructor({image:new this.OlStyleIconConstructor({src:S.getBase64EncodedSvg(F),crossOrigin:"anonymous",...d&&{displacement:d},...x&&Number.isFinite(x)&&{opacity:x},...f&&{rotation:f},scale:1})})}else if(S.getIsFontGlyphBased(t)){const y=i&&s?S.getRgbaColor(i,s):i,x=c&&l?S.getRgbaColor(c,l):c,C=new this.OlStyleStrokeConstructor({...y&&{color:y},...a&&{width:a}}),F=new this.OlStyleFillConstructor({...x&&{color:x}});p=new this.OlStyleConstructor({text:new this.OlStyleTextConstructor({text:S.getCharacterForMarkSymbolizer(t),font:S.getTextFontForMarkSymbolizer(t),...F&&{fill:F},...d&&{offsetX:d[0]},...d&&{offsetY:d[1]},...C&&{stroke:C},...f&&{rotation:f}})})}else throw new Error("MarkSymbolizer cannot be parsed. Unsupported WellKnownName.");return p}async getOlIconSymbolizerFromIconSymbolizer(t,e){for(const f of Object.keys(t))B(t[f])&&(t[f]=S.evaluateFunction(t[f],e));const i={src:At(t.image)?t.image.source:t.image,crossOrigin:"anonymous",opacity:t.opacity,width:t.size,rotation:typeof t.rotate=="number"?t.rotate*Math.PI/180:void 0,displacement:t.offset,size:At(t.image)?t.image.size:void 0,offset:At(t.image)?t.image.position:void 0},s="\\{\\{",a="\\}\\}",c=new RegExp(s+".*?"+a,"g");return(typeof t.image=="string"?t.image.match(c):null)?d=>{let p=S.resolveAttributeTemplate(d,t.image,"");p||(p=t.image+"");let _;return this.olIconStyleCache[p]?(_=this.olIconStyleCache[p],i.rotation!==void 0&&_.setRotation(i.rotation),i.opacity!==void 0&&_.setOpacity(i.opacity)):(_=new this.OlStyleIconConstructor({...i,src:p}),this.olIconStyleCache[p]=_),new this.OlStyleConstructor({image:_})}:new this.OlStyleConstructor({image:new this.OlStyleIconConstructor({...i})})}getOlLineSymbolizerFromLineSymbolizer(t,e){for(const c of Object.keys(t))B(t[c])&&(t[c]=S.evaluateFunction(t[c],e));const i=t.color,s=t.opacity,a=i&&s!==null&&s!==void 0?S.getRgbaColor(i,s):i;return new this.OlStyleConstructor({stroke:new this.OlStyleStrokeConstructor({color:a,width:t.width,lineCap:t.cap,lineJoin:t.join,lineDash:t.dasharray,lineDashOffset:t.dashOffset})})}async getOlPolygonSymbolizerFromFillSymbolizer(t,e){for(const y of Object.keys(t))B(t[y])&&(t[y]=S.evaluateFunction(t[y],e));const i=t.color,s=t.fillOpacity,a=i&&Number.isFinite(s)?S.getRgbaColor(i,s):i;let c=i?new this.OlStyleFillConstructor({color:a}):void 0;const l=t.outlineColor,f=t.outlineOpacity,d=l&&Number.isFinite(f)?S.getRgbaColor(l,f):l,p=l||t.outlineWidth?new this.OlStyleStrokeConstructor({color:d,width:t.outlineWidth,lineDash:t.outlineDasharray}):void 0,_=new this.OlStyleConstructor({fill:c,stroke:p});if(t.graphicFill){const y=this.getOlPatternFromGraphicFill(t.graphicFill);c||(c=new this.OlStyleFillConstructor({})),y&&c.setColor(await y),_.setFill(c)}return _}async getOlPatternFromGraphicFill(t){let e,i=[16,16];const s=new Image;if(gi(t)){e=await this.getOlIconSymbolizerFromIconSymbolizer(t);const y=e==null?void 0:e.getImage();if(await(y==null?void 0:y.load()),(y==null?void 0:y.getImageState())!==O.LOADED)return null;i=e.getSize()}else if(di(t)){e=await this.getOlPointSymbolizerFromMarkSymbolizer(t),s.src=e.getImage().getSrc();const y=S.getBase64DecodedSvg(s.src),{dimensions:x}=Ze(y);x&&(i=[x,x])}else return null;const a=e.clone(),c=a.getImage(),f=document.createElement("canvas").getContext("2d"),p=c.getScale()||1;c.setScale(1);const _=jn(f,{pixelRatio:p,size:i});return c.onload=()=>{const y=i.map(C=>C/2),x=new Kn(new gn(y));_.drawFeature(x,a)},new Promise((y,x)=>{const C=document.createElement("canvas"),F=C.getContext("2d");if(!F){x(new Error("Failed to get canvas context"));return}s.onload=()=>{C.width=i[0],C.height=i[1],F.drawImage(s,0,0);const k=F.createPattern(C,"repeat");if(!k){x(new Error("Failed to create pattern"));return}y(k)},s.onerror=k=>{x(new Error("Failed to load image: "+k))}})}getOlTextSymbolizerFromTextSymbolizer(t,e){for(const F of Object.keys(t))B(t[F])&&(t[F]=S.evaluateFunction(t[F],e));const i=t.color;let s=t.placement;s||(s="point"),s==="line-center"&&(s="line");const a=t.opacity,c=i&&Number.isFinite(a)?S.getRgbaColor(i,a):i,l=t.haloColor,f=t.haloWidth,d=l&&Number.isFinite(a)?S.getRgbaColor(l,a):l,p={font:S.getTextFont(t),fill:new this.OlStyleFillConstructor({color:c}),stroke:new this.OlStyleStrokeConstructor({color:d,width:f||0}),overflow:t.allowOverlap,offsetX:t.offset?t.offset[0]:0,offsetY:t.offset?t.offset[1]:0,rotation:typeof t.rotate=="number"?t.rotate*Math.PI/180:void 0,placement:s},_="\\{\\{",y="\\}\\}",x=new RegExp(_+".*?"+y,"g");let C;return lt(t.label)||(C=t.label?t.label.match(x):null),C?k=>{const E=new this.OlStyleTextConstructor({text:S.resolveAttributeTemplate(k,t.label,""),...p});return new this.OlStyleConstructor({text:E})}:new this.OlStyleConstructor({text:new this.OlStyleTextConstructor({text:t.label,...p})})}}return U(oe,"title","OpenLayers Style Parser"),$.OlStyleParser=oe,$.default=oe,Object.defineProperty($,"__esModule",{value:!0}),$}({});
//# sourceMappingURL=olStyleParser.iife.js.map
